%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% OXFORD THESIS TEMPLATE

% Use this template to produce a standard thesis that meets the Oxford University requirements for DPhil submission
%
% Originally by Keith A. Gillow (gillow@maths.ox.ac.uk), 1997
% Modified by Sam Evans (sam@samuelevansresearch.org), 2007
% Modified by John McManigle (john@oxfordechoes.com), 2015
% Modified by Ulrik Lyngs (ulrik.lyngs@cs.ox.ac.uk), 2018-, for use with R Markdown
%
% Ulrik Lyngs, 25 Nov 2018: Following John McManigle, broad permissions are granted to use, modify, and distribute this software
% as specified in the MIT License included in this distribution's LICENSE file.
%
% John commented this file extensively, so read through to see how to use the various options.  Remember that in LaTeX,
% any line starting with a % is NOT executed.  Several places below, you have a choice of which line to use
% out of multiple options (eg draft vs final, for PDF vs for binding, etc.)  When you pick one, add a % to the beginning of
% the lines you don't want.


%%%%% PAGE LAYOUT
% The most common choices should be below.  You can also do other things, like replacing "a4paper" with "letterpaper", etc.

% This one formats for two-sided binding (ie left and right pages have mirror margins; blank pages inserted where needed):
%\documentclass[a4paper,twoside]{templates/ociamthesis}
% This one formats for one-sided binding (ie left margin > right margin; no extra blank pages):
%\documentclass[a4paper]{ociamthesis}
% This one formats for PDF output (ie equal margins, no extra blank pages):
%\documentclass[a4paper,nobind]{templates/ociamthesis}

% As you can see from the uncommented line below, oxforddown template uses the a4paper size, 
% and passes in the binding option from the YAML header in index.Rmd:
\documentclass[a4paper, nobind]{templates/ociamthesis}


%%%%% ADDING LATEX PACKAGES
% add hyperref package with options from YAML %
\usepackage[pdfpagelabels]{hyperref}
% change the default coloring of links to something sensible
\usepackage{xcolor}
\usepackage[hangul]{kotex}


\definecolor{mylinkcolor}{RGB}{0,0,139}
\definecolor{myurlcolor}{RGB}{0,0,139}
\definecolor{mycitecolor}{RGB}{0,33,71}

\hypersetup{
  hidelinks,
  colorlinks,
  linktocpage=true,
  linkcolor=mylinkcolor,
  urlcolor=myurlcolor,
  citecolor=mycitecolor
}



% add float package to allow manual control of figure positioning %
\usepackage{float}

% enable strikethrough
\usepackage[normalem]{ulem}

% use soul package for correction highlighting
\usepackage{color, soul}
\definecolor{correctioncolor}{HTML}{CCCCFF}
\sethlcolor{correctioncolor}
\newcommand{\ctext}[3][RGB]{%
  \begingroup
  \definecolor{hlcolor}{#1}{#2}\sethlcolor{hlcolor}%
  \hl{#3}%
  \endgroup
}
\soulregister\ref7
\soulregister\cite7
\soulregister\autocite7
\soulregister\textcite7
\soulregister\pageref7

%%%%% FIXING / ADDING THINGS THAT'S SPECIAL TO R MARKDOWN'S USE OF LATEX TEMPLATES
% pandoc puts lists in 'tightlist' command when no space between bullet points in Rmd file,
% so we add this command to the template
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
 
% UL 1 Dec 2018, fix to include code in shaded environments
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}

%UL set white space before and after code blocks
\renewenvironment{Shaded}
{
  \vspace{10pt}%
  \begin{snugshade}%
}{%
  \end{snugshade}%
  \vspace{8pt}%
}

% User-included things with header_includes or in_header will appear here
% kableExtra packages will appear here if you use library(kableExtra)
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{float}
\usepackage{colortbl}
\usepackage{pdflscape}
\usepackage{tabu}
\usepackage{threeparttable}
\usepackage{threeparttablex}
\usepackage[normalem]{ulem}
\usepackage{makecell}
\usepackage{xcolor}


%UL set section header spacing
\usepackage{titlesec}
% 
\titlespacing\subsubsection{0pt}{24pt plus 4pt minus 2pt}{0pt plus 2pt minus 2pt}


%UL set whitespace around verbatim environments
\usepackage{etoolbox}
\makeatletter
\preto{\@verbatim}{\topsep=0pt \partopsep=0pt }
\makeatother



%%%%%%% PAGE HEADERS AND FOOTERS %%%%%%%%%
\usepackage{fancyhdr}
\setlength{\headheight}{15pt}
\fancyhf{} % clear the header and footers
\pagestyle{fancy}
\renewcommand{\chaptermark}[1]{\markboth{\thechapter. #1}{\thechapter. #1}}
\renewcommand{\sectionmark}[1]{\markright{\thesection. #1}} 
\renewcommand{\headrulewidth}{0pt}

\fancyhead[LO]{\emph{\leftmark}} 
\fancyhead[RE]{\emph{\rightmark}} 

% UL page number position 
\fancyfoot[R]{\emph{\thepage}} %regular pages
\fancypagestyle{plain}{\fancyhf{}\fancyfoot[R]{\emph{\thepage}}} %chapter pages

% JEM fix header on cleared pages for openright
\def\cleardoublepage{\clearpage\if@twoside \ifodd\c@page\else
   \hbox{}
   \fancyfoot[R]{}
   \newpage
   \if@twocolumn\hbox{}\newpage
   \fi
   \fancyhead[LO]{\emph{\leftmark}} 
   \fancyhead[RE]{\emph{\rightmark}} 
   \fi\fi}


%%%%% SELECT YOUR DRAFT OPTIONS
% This adds a "DRAFT" footer to every normal page.  (The first page of each chapter is not a "normal" page.)
\fancyfoot[C]{\emph{DRAFT Printed on \today}}

% IP feb 2021: option to include line numbers in PDF

% This highlights (in blue) corrections marked with (for words) \mccorrect{blah} or (for whole
% paragraphs) \begin{mccorrection} . . . \end{mccorrection}.  This can be useful for sending a PDF of
% your corrected thesis to your examiners for review.  Turn it off, and the blue disappears.
\correctionstrue


%%%%% BIBLIOGRAPHY SETUP
% Note that your bibliography will require some tweaking depending on your department, preferred format, etc.
% If you've not used LaTeX before, I recommend reading a little about biblatex/biber and getting started with it.
% If you're already a LaTeX pro and are used to natbib or something, modify as necessary.
% Either way, you'll have to choose and configure an appropriate bibliography format...


\usepackage[style=authoryear, sorting=nyt, backend=biber, maxcitenames=2, useprefix, doi=true, isbn=false, uniquename=false]{biblatex}
\newcommand*{\bibtitle}{Works Cited}

\addbibresource{bibliography/references.bib}
\addbibresource{bibliography/additional-references.bib}


% This makes the bibliography left-aligned (not 'justified') and slightly smaller font.
\renewcommand*{\bibfont}{\raggedright\small}


% Uncomment this if you want equation numbers per section (2.3.12), instead of per chapter (2.18):
%\numberwithin{equation}{subsection}


%%%%% THESIS / TITLE PAGE INFORMATION
% Everybody needs to complete the following:
\title{\texttt{FLAC3D} Gitbook}
\author{Kyeong Sun Kim}
\college{Civil and Environmental Engineering}

% Master's candidates who require the alternate title page (with candidate number and word count)
% must also un-comment and complete the following three lines:

% Uncomment the following line if your degree also includes exams (eg most masters):
%\renewcommand{\submittedtext}{Submitted in partial completion of the}
% Your full degree name.  (But remember that DPhils aren't "in" anything.  They're just DPhils.)
\degree{}
% Term and year of submission, or date if your board requires (eg most masters)
\degreedate{Sept, 2021}


%%%%% YOUR OWN PERSONAL MACROS
% This is a good place to dump your own LaTeX macros as they come up.

% To make text superscripts shortcuts
	\renewcommand{\th}{\textsuperscript{th}} % ex: I won 4\th place
	\newcommand{\nd}{\textsuperscript{nd}}
	\renewcommand{\st}{\textsuperscript{st}}
	\newcommand{\rd}{\textsuperscript{rd}}

%%%%% THE ACTUAL DOCUMENT STARTS HERE
\begin{document}

%%%%% CHOOSE YOUR LINE SPACING HERE
% This is the official option.  Use it for your submission copy and library copy:
\setlength{\textbaselineskip}{22pt plus2pt}
% This is closer spacing (about 1.5-spaced) that you might prefer for your personal copies:
%\setlength{\textbaselineskip}{18pt plus2pt minus1pt}

% You can set the spacing here for the roman-numbered pages (acknowledgements, table of contents, etc.)
\setlength{\frontmatterbaselineskip}{17pt plus1pt minus1pt}

% UL: You can set the line and paragraph spacing here for the separate abstract page to be handed in to Examination schools
\setlength{\abstractseparatelineskip}{13pt plus1pt minus1pt}
\setlength{\abstractseparateparskip}{0pt plus 1pt}

% UL: You can set the general paragraph spacing here - I've set it to 2pt (was 0) so
% it's less claustrophobic
\setlength{\parskip}{2pt plus 1pt}

%
% Oxford University logo on title page
%
\def\crest{{\includegraphics[width=5cm]{templates/snupdf.pdf}}}
\renewcommand{\university}{Seoul National University}
\renewcommand{\submittedtext}{}


% Leave this line alone; it gets things started for the real document.
\setlength{\baselineskip}{\textbaselineskip}


%%%%% CHOOSE YOUR SECTION NUMBERING DEPTH HERE
% You have two choices.  First, how far down are sections numbered?  (Below that, they're named but
% don't get numbers.)  Second, what level of section appears in the table of contents?  These don't have
% to match: you can have numbered sections that don't show up in the ToC, or unnumbered sections that
% do.  Throughout, 0 = chapter; 1 = section; 2 = subsection; 3 = subsubsection, 4 = paragraph...

% The level that gets a number:
\setcounter{secnumdepth}{3}
% The level that shows up in the ToC:
\setcounter{tocdepth}{2}


%%%%% ABSTRACT SEPARATE
% This is used to create the separate, one-page abstract that you are required to hand into the Exam
% Schools.  You can comment it out to generate a PDF for printing or whatnot.

% JEM: Pages are roman numbered from here, though page numbers are invisible until ToC.  This is in
% keeping with most typesetting conventions.
\begin{romanpages}

% Title page is created here
\maketitle

%%%%% DEDICATION -- If you'd like one, un-comment the following.

%%%%% ACKNOWLEDGEMENTS -- Nothing to do here except comment out if you don't want it.


%%%%% ABSTRACT -- Nothing to do here except comment out if you don't want it.
%\begin{abstract}
%	
%\end{abstract}

%%%%% MINI TABLES
% This lays the groundwork for per-chapter, mini tables of contents.  Comment the following line
% (and remove \minitoc from the chapter files) if you don't want this.  Un-comment either of the
% next two lines if you want a per-chapter list of figures or tables.
  \dominitoc % include a mini table of contents

% This aligns the bottom of the text of each page.  It generally makes things look better.
\flushbottom

% This is where the whole-document ToC appears:
\tableofcontents


% Uncomment to generate a list of tables:
%%%%% LIST OF ABBREVIATIONS
% This example includes a list of abbreviations.  Look at text/abbreviations.tex to see how that file is
% formatted.  The template can handle any kind of list though, so this might be a good place for a
% glossary, etc.

% The Roman pages, like the Roman Empire, must come to its inevitable close.
\end{romanpages}

%%%%% CHAPTERS
% Add or remove any chapters you'd like here, by file name (excluding '.tex'):
\flushbottom

% all your chapters and appendices will appear here
\minitoc

\newpage

\begin{savequote}
There is grandeur in this view of life, with its several powers, having
been originally breathed into a few forms or into one; and that, whilst
this planet has gone cycling on according to the fixed law of gravity,
from so simple a beginning endless forms most beautiful and most
wonderful have been, and are being, evolved.
\qauthor{Charles Darwin(1809-1882)}\end{savequote}

\hypertarget{kaist-model}{%
\chapter{KAIST Model}\label{kaist-model}}

\hypertarget{initial-configuration}{%
\section{Initial Configuration}\label{initial-configuration}}

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ itasca }\ImportTok{as}\NormalTok{ it}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}
\NormalTok{np.set\_printoptions(threshold}\OperatorTok{=}\DecValTok{20}\NormalTok{)}
\NormalTok{it.command(}\StringTok{"python{-}reset{-}state false"}\NormalTok{)}
\ImportTok{from}\NormalTok{ itasca }\ImportTok{import}\NormalTok{ zonearray }\ImportTok{as}\NormalTok{ za}
\ImportTok{from}\NormalTok{ itasca }\ImportTok{import}\NormalTok{ gridpointarray }\ImportTok{as}\NormalTok{ gpa}

\CommentTok{\# PARAMETERS \#}

\NormalTok{\_D\_shaft }\OperatorTok{=} \DecValTok{1}
\NormalTok{\_H\_shaft }\OperatorTok{=} \FloatTok{7.45}
\NormalTok{\_T\_plate }\OperatorTok{=} \FloatTok{1.5}
\NormalTok{\_B\_footing }\OperatorTok{=} \FloatTok{3.25}
\NormalTok{\_D\_footing }\OperatorTok{=}\NormalTok{ \_H\_shaft }\OperatorTok{+}\NormalTok{ \_T\_plate}
\NormalTok{\_B\_soil }\OperatorTok{=}\NormalTok{ \_B\_footing}\OperatorTok{*}\DecValTok{5}
\NormalTok{\_D\_soil }\OperatorTok{=}\NormalTok{ \_D\_footing}\OperatorTok{+}\DecValTok{3}

\NormalTok{\_radial }\OperatorTok{=} \DecValTok{50}
\NormalTok{\_perimeter }\OperatorTok{=} \DecValTok{2}\OperatorTok{*}\NormalTok{\_radial}
\NormalTok{\_axial }\OperatorTok{=} \DecValTok{2}\OperatorTok{*}\NormalTok{\_radial}
\NormalTok{\_outer }\OperatorTok{=} \DecValTok{2}\OperatorTok{*}\NormalTok{\_radial}

\NormalTok{\_bulk }\OperatorTok{=} \FloatTok{13.9e9}
\NormalTok{\_shear }\OperatorTok{=} \FloatTok{10.4e9}

\NormalTok{\_E\_o }\OperatorTok{=} \FloatTok{1e7}
\NormalTok{\_const }\OperatorTok{=} \FloatTok{1e8}
\NormalTok{\_poisson }\OperatorTok{=} \FloatTok{0.25}
\end{Highlighting}
\end{Shaded}

\hypertarget{zones}{%
\section{Zones}\label{zones}}

\includegraphics[width=1\linewidth]{myfigureeeeee/final-block-square1}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# ZONE \#}
\NormalTok{command\_zone }\OperatorTok{=} \StringTok{"""}
\StringTok{model new}
\StringTok{z crea r{-}t p 0 (0,0,0) ...}
\StringTok{           p 1 (}\SpecialCharTok{\{B\_soil\}}\StringTok{,0,0) ... }
\StringTok{           p 2 (0,}\SpecialCharTok{\{D\_soil\}}\StringTok{,0) ...}
\StringTok{           p 3 (0,0,}\SpecialCharTok{\{B\_soil\}}\StringTok{) ...}
\StringTok{           p 4 (}\SpecialCharTok{\{B\_soil\}}\StringTok{,}\SpecialCharTok{\{D\_soil\}}\StringTok{,0) ...}
\StringTok{           p 5 (0,}\SpecialCharTok{\{D\_soil\}}\StringTok{,}\SpecialCharTok{\{B\_soil\}}\StringTok{) ...}
\StringTok{           p 6 (}\SpecialCharTok{\{B\_soil\}}\StringTok{,0,}\SpecialCharTok{\{B\_soil\}}\StringTok{) ...}
\StringTok{           p 7 (}\SpecialCharTok{\{B\_soil\}}\StringTok{,}\SpecialCharTok{\{D\_soil\}}\StringTok{,}\SpecialCharTok{\{B\_soil\}}\StringTok{) ...}
\StringTok{           p 8 (}\SpecialCharTok{\{B\_footing\}}\StringTok{,0,0) ...}
\StringTok{           p 9 (0,0,}\SpecialCharTok{\{B\_footing\}}\StringTok{) ...}
\StringTok{           p 10 (}\SpecialCharTok{\{B\_footing\}}\StringTok{,}\SpecialCharTok{\{D\_soil\}}\StringTok{,0) ...}
\StringTok{           p 11 (0,}\SpecialCharTok{\{D\_soil\}}\StringTok{,}\SpecialCharTok{\{B\_footing\}}\StringTok{) ...}
\StringTok{           p 12 (}\SpecialCharTok{\{B\_footing\}}\StringTok{,0,}\SpecialCharTok{\{B\_footing\}}\StringTok{) ...}
\StringTok{           p 13 (}\SpecialCharTok{\{B\_footing\}}\StringTok{,}\SpecialCharTok{\{D\_soil\}}\StringTok{,}\SpecialCharTok{\{B\_footing\}}\StringTok{) ...}
\StringTok{           size }\SpecialCharTok{\{radial\}}\StringTok{ }\SpecialCharTok{\{axial\}}\StringTok{ }\SpecialCharTok{\{perimeter\}}\StringTok{ }\SpecialCharTok{\{outer\}}\StringTok{ ...}
\StringTok{           rat 1 1 1 1.01 ...}
\StringTok{           fill}
\StringTok{"""}

\NormalTok{command }\OperatorTok{=}\NormalTok{ command\_zone.}\BuiltInTok{format}\NormalTok{(}
\NormalTok{B\_footing }\OperatorTok{=}\NormalTok{ \_B\_footing,}
\NormalTok{B\_soil }\OperatorTok{=}\NormalTok{ \_B\_soil,}
\NormalTok{D\_soil }\OperatorTok{=}\NormalTok{ \_D\_soil,}
\NormalTok{radial}\OperatorTok{=}\NormalTok{\_radial,}
\NormalTok{axial }\OperatorTok{=}\NormalTok{ \_axial,}
\NormalTok{perimeter }\OperatorTok{=}\NormalTok{ \_perimeter,}
\NormalTok{outer }\OperatorTok{=}\NormalTok{ \_outer)}

\NormalTok{it.command(command)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=1\linewidth]{myfigureeeeee/e}

\includegraphics[width=1\linewidth]{myfigureeeeee/f}

\hypertarget{group}{%
\section{Group}\label{group}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# GROUP \#}
\NormalTok{p }\OperatorTok{=}\NormalTok{ za.pos()}
\NormalTok{x,y,z }\OperatorTok{=}\NormalTok{ p.T}
\BuiltInTok{print}\NormalTok{(it.zone.count(), }\StringTok{"zones in whole model"}\NormalTok{)}

\NormalTok{shaft }\OperatorTok{=} \BuiltInTok{reduce}\NormalTok{(np.logical\_and, (np.sqrt(x}\OperatorTok{**}\DecValTok{2}\OperatorTok{+}\NormalTok{z}\OperatorTok{**}\DecValTok{2}\NormalTok{)}\OperatorTok{\textless{}}\NormalTok{\_D\_shaft, y}\OperatorTok{\textless{}}\NormalTok{\_H\_shaft))}
\NormalTok{za.set\_group(shaft, }\StringTok{"shaft"}\NormalTok{) }\CommentTok{\# set the zones with shaft = true have "shaft" and "geometry"}
\BuiltInTok{print}\NormalTok{(za.in\_group(}\StringTok{"shaft"}\NormalTok{).}\BuiltInTok{sum}\NormalTok{(), }\StringTok{"zones in shaft group."}\NormalTok{) }\CommentTok{\#output how many zones are in the corner group}

\NormalTok{plate }\OperatorTok{=} \BuiltInTok{reduce}\NormalTok{(np.logical\_and, (x}\OperatorTok{\textless{}}\NormalTok{\_B\_footing,z}\OperatorTok{\textless{}}\NormalTok{\_B\_footing, y}\OperatorTok{\textgreater{}}\NormalTok{\_H\_shaft,y}\OperatorTok{\textless{}}\NormalTok{\_D\_footing))}
\NormalTok{za.set\_group(plate, }\StringTok{"plate"}\NormalTok{) }\CommentTok{\# set the zones with plate = true have "plate" and "geometry"}
\BuiltInTok{print}\NormalTok{(za.in\_group(}\StringTok{"plate"}\NormalTok{).}\BuiltInTok{sum}\NormalTok{(), }\StringTok{"zones in plate group."}\NormalTok{) }\CommentTok{\#output how many zones are in the corner group}
\end{Highlighting}
\end{Shaded}

\hypertarget{constitutive-model}{%
\section{Constitutive Model}\label{constitutive-model}}

Besides standard looping as depicted above, one can easily loop over sets of model objects (i.e., zones, gridpoints, structural element nodes, etc.) using the loop foreach construct. In this case, a container of objects must be given by a FISH intrinsic such as zone.list. A practical use of the loop foreach construct is to install a nonlinear initial distribution of elastic moduli in a FLAC3D grid. Suppose that the Young's modulus at a site is given by this equation:

\[ E = E_0 + c \sqrt{z}  \]
where z is the depth below surface, and c and E∘ are constants. We write a FISH function to install appropriate values of bulk and shear modulus in the grid, as in this example:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# CONSTITUTIVE MODEL}
\NormalTok{it.command(}\StringTok{"""}
\StringTok{zone cmodel assign elastic range group "Radial Tunnel1"}
\StringTok{zone cmodel assign elastic range group \textquotesingle{}shaft\textquotesingle{}}
\StringTok{zone cmodel assign elastic range group \textquotesingle{}plate\textquotesingle{}}

\StringTok{fish define fname(E\_o,const)}
\StringTok{loop foreach pnt zone.list}
\StringTok{z\_depth = zone.pos.y(pnt)}
\StringTok{E = E\_o+const*math.sqrt(z\_depth)}
\StringTok{zone.prop(pnt,\textquotesingle{}young\textquotesingle{})=E}
\StringTok{end\_loop}
\StringTok{end}
\StringTok{@fname(}\SpecialCharTok{\{E\_o\_\}}\StringTok{,}\SpecialCharTok{\{const\_\}}\StringTok{)}
\StringTok{zone property poisson }\SpecialCharTok{\{poisson\_\}}
\StringTok{plot item create zone contour property name \textquotesingle{}young\textquotesingle{}}
\StringTok{"""}\NormalTok{.}\BuiltInTok{format}\NormalTok{(E\_o\_}\OperatorTok{=}\NormalTok{\_E\_o,const\_}\OperatorTok{=}\NormalTok{\_const,poisson\_}\OperatorTok{=}\NormalTok{\_poisson))}

\NormalTok{it.command(}\StringTok{"""}
\StringTok{zone property bulk }\SpecialCharTok{\{bulk\}}\StringTok{  shear }\SpecialCharTok{\{shear\}}\StringTok{ range group \textquotesingle{}shaft\textquotesingle{}}
\StringTok{zone property bulk }\SpecialCharTok{\{bulk\}}\StringTok{  shear }\SpecialCharTok{\{shear\}}\StringTok{ range group \textquotesingle{}plate\textquotesingle{}}
\StringTok{"""}\NormalTok{.}\BuiltInTok{format}\NormalTok{(bulk}\OperatorTok{=}\NormalTok{\_bulk,shear}\OperatorTok{=}\NormalTok{\_shear))}
\end{Highlighting}
\end{Shaded}

Again, you can verify correct operation of the function by printing or plotting shear and bulk moduli.

In the function install, the loop takes place over all zones in the global list of zones. The FISH statement loop foreach is a variation of the loop statement that sets pnt to each zone in zone.list. Inside the loop, the z-coordinate of each zone centroid is used to calculate the Young's modulus, given in the equation above. We assume that the datum (or ground surface reference point) is at z = 0. The variables zone.pos.z(pnt) and zone.prop(pnt, `young') are zone intrinsics. (Recall that we talked about the gridpoint intrinsic gp.force.unbal earlier.) Here, we set properties directly from within a FISH function, rather than with a zone property command as in an earlier example.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# SOFTENING MODEL \#}
\CommentTok{\#it.command("""}
\CommentTok{\#zone cmodel assign strain{-}softening range group "Radial Tunnel1"}
\CommentTok{\#zone property density 2500 bulk 2e8 shear 1e8 range group "Radial Tunnel1"}
\CommentTok{\#zone property cohesion 2e6 friction 45 tension 2e5 dilation 10 range group "Radial Tunnel1"}
\CommentTok{\#zone property table{-}friction \textquotesingle{}fri\textquotesingle{} table{-}cohesion \textquotesingle{}coh\textquotesingle{} table{-}dilation \textquotesingle{}dil\textquotesingle{} range group "Radial Tunnel1"}
\CommentTok{\#table \textquotesingle{}fri\textquotesingle{} add (0, 45) (.05, 42) (.1, 40) (1, 40)}
\CommentTok{\#table \textquotesingle{}coh\textquotesingle{} add (0,2e6) (.05,1e6) (.1,5e5) (1,5e5) }
\CommentTok{\#table \textquotesingle{}dil\textquotesingle{} add (0, 10) (.05,  3) (.1,  0)}
\CommentTok{\#""")}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=1\linewidth]{myfigureeeeee/g}

\includegraphics[width=1\linewidth]{myfigureeeeee/concrete-properties}

\hypertarget{soil-structure-interface}{%
\section{Soil-Structure Interface}\label{soil-structure-interface}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# INTERFACE}
\end{Highlighting}
\end{Shaded}

\hypertarget{boundary-conditions}{%
\section{Boundary Conditions}\label{boundary-conditions}}

\hypertarget{initial-equilibrium}{%
\section{Initial Equilibrium}\label{initial-equilibrium}}

\hypertarget{alterations}{%
\section{Alterations}\label{alterations}}

\hypertarget{results}{%
\section{Results}\label{results}}

\newpage

\begin{savequote}
My modelling choices\\
Are founded in logic.\\
Can I convince you?\\
If you look down,\\
Are you surprised to see\\
Only your feet?\\
The train keeps to the tracks\\
But the country around\\
Remains unexplored.\\
The excellent map\\
misses no detail, but it is\\
as large as the world.
\qauthor{Muir Wood(2004)}\end{savequote}

\hypertarget{axial-concrete-pile}{%
\chapter{Axial Concrete Pile}\label{axial-concrete-pile}}

\includegraphics[width=1\linewidth]{myfigureeeeee/h}

\hypertarget{problem-description}{%
\section{Problem Description}\label{problem-description}}

\hypertarget{problem-statement}{%
\subsection{Problem Statement}\label{problem-statement}}

The pile is subjected to an axial load of 100 kN,
and then the top of the pile is moved horizontally for a displacement of 4 cm.
The goal is to determine relation of axial loading to the ultimate bearing capacity.
And, lateral load-deflection curve is calculated.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  origin at the top of the pile, z upward.
\item
  z=0: free surface
\item
  z=-8: fixed in z-eirection
\item
  x=+8, -8, y = 8: roller
\item
  skin friction is modeled by placing an interface
  between pile concrete wall and clay.
  In it, fric angle of 20 and c=30kPa are assumed.
\item
  toe interface is placed between pile tip and clay
  \emph{note: Zone faces are separated in a previous command so that the gridpoints common to both will be separated as well.}\\
  \emph{note: include Figure of grid (geometry)}
\end{enumerate}

\hypertarget{main-parameters}{%
\subsection{Main Parameters}\label{main-parameters}}

Diameter = 0.6 m\\
Length = 5\\
Clay\\
GWT = 5.5m\\

\hypertarget{modeling-procedure}{%
\section{Modeling Procedure}\label{modeling-procedure}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  equil. stress state under gravity load before install.\\
  1-1) water table is created at z=5.5\\
  1-2) wet density of clay is assigned below this water table.\\
\item
  equil. stress state after installation.\\
  2-1) change properties of pile zones from those\\
  representing clay to those representing concrete.\\
  2-2) vertical equil. stress distribution at this equil. state is shown in\\
  \emph{note: include Figure of contours of vertical stress at ini state incld. pile weight}\\
\item
  apply vertical velocity at top of pile\\
  ``ramp'' = boundary condition is increased linearly\\
  \emph{note: critical timestep is controlled by high stiffness of concrete}\\
  If velocity is sudden, inertial effects will dominate and renders difficulty to identification of steady state response of system\\
  table ``ramp'' is used to apply velocity to pile top gridpoints.\\
  \emph{note: FISH FUNCTION vert\_load calculates axial stress at the top of pile and stores value as a history}\\
  For efficiency, gridpoints on cap surface are stored in symbol ``cap'' as a map\\
  \emph{note: include plot of axial stress vs axial displ. at pile toe. ramp = (0,5e-8), step number = 30000}\\
  \emph{note: combined damping is used to remove kinetic energy for prescribed loading condition. This is because mass-adjustment process depends on velocity sign-changes..}\\
  \emph{note: FISH FUNCTION tot\_reac monitors soil reaction along pile as a func of lateral displ. tot\_reac creates tables of soil reaction (p) vs.~lateral displ (y) at diff. locations along pile to generate p-y curve.}\\
  \emph{note: include Figure of p-y curve at 11 equidistant points along pile}\\
\end{enumerate}

\hypertarget{zones-1}{%
\section{Zones}\label{zones-1}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model new}
\NormalTok{model title }\StringTok{\textquotesingle{}Axial and lateral loading of a concrete pile\textquotesingle{}}
\OperatorTok{;}\NormalTok{ create grid interactively }\ImportTok{from}\NormalTok{ the extruder tool, }
\OperatorTok{;}\NormalTok{ exported to geometry.f3dat }\ImportTok{from}\NormalTok{ State Record pane.}
\NormalTok{call }\StringTok{\textquotesingle{}geometry\textquotesingle{}}\NormalTok{ suppress}
\NormalTok{zone generate }\ImportTok{from}\OperatorTok{{-}}\NormalTok{extruder}
\OperatorTok{;}\NormalTok{ Reflect the grid to get a }\DecValTok{1}\OperatorTok{/}\DecValTok{2}\NormalTok{ space instead of a }\DecValTok{1}\OperatorTok{/}\DecValTok{4}\NormalTok{ space}
\NormalTok{zone reflect dip}\OperatorTok{{-}}\NormalTok{direction }\DecValTok{270}\NormalTok{ dip }\DecValTok{90}
\end{Highlighting}
\end{Shaded}

\hypertarget{groups}{%
\section{Groups}\label{groups}}

\begin{Shaded}
\begin{Highlighting}[]
\OperatorTok{;}\NormalTok{ Name intersections of things named }\KeywordTok{in}\NormalTok{ the two extruder views}
\NormalTok{zone group }\StringTok{\textquotesingle{}clay\textquotesingle{}} \BuiltInTok{range}\NormalTok{ group }\StringTok{\textquotesingle{}clay{-}c\textquotesingle{}} \KeywordTok{or} \StringTok{\textquotesingle{}clay{-}s\textquotesingle{}} \KeywordTok{or} \StringTok{\textquotesingle{}wetclay{-}s\textquotesingle{}}
\NormalTok{zone group }\StringTok{\textquotesingle{}pile\textquotesingle{}} \BuiltInTok{range}\NormalTok{ group }\StringTok{\textquotesingle{}pile{-}c\textquotesingle{}}\NormalTok{ group }\StringTok{\textquotesingle{}pile{-}s\textquotesingle{}} \KeywordTok{or} \StringTok{\textquotesingle{}remove{-}s\textquotesingle{}}
\NormalTok{zone group }\StringTok{\textquotesingle{}remove\textquotesingle{}} \BuiltInTok{range}\NormalTok{ group }\StringTok{\textquotesingle{}remove{-}s\textquotesingle{}}\NormalTok{ group }\StringTok{\textquotesingle{}pile{-}c\textquotesingle{}} \KeywordTok{not} \OperatorTok{;} 
\NormalTok{zone face group }\StringTok{\textquotesingle{}wall\textquotesingle{}}\NormalTok{ internal }\BuiltInTok{range}\NormalTok{ group }\StringTok{\textquotesingle{}wall{-}c\textquotesingle{}}\NormalTok{ group }\StringTok{\textquotesingle{}pile\textquotesingle{}}
\NormalTok{zone face group }\StringTok{\textquotesingle{}base\textquotesingle{}}\NormalTok{ internal }\BuiltInTok{range}\NormalTok{ group }\StringTok{\textquotesingle{}base{-}s\textquotesingle{}}\NormalTok{ group }\StringTok{\textquotesingle{}pile\textquotesingle{}}
\NormalTok{zone face skin }\OperatorTok{;}\NormalTok{ Name far field boundaries}
\OperatorTok{;}\NormalTok{ Delete the area marked }\ControlFlowTok{for}\NormalTok{ removal}
\NormalTok{zone delete }\BuiltInTok{range}\NormalTok{ group }\StringTok{\textquotesingle{}remove\textquotesingle{}}
\OperatorTok{;}
\OperatorTok{;}\NormalTok{ setup interfaces}
\OperatorTok{;}\NormalTok{ separate using zone separate}
\OperatorTok{;} \BuiltInTok{all}\NormalTok{ at once so common nodes are separated}
\NormalTok{zone separate by}\OperatorTok{{-}}\NormalTok{face new}\OperatorTok{{-}}\NormalTok{side group }\StringTok{\textquotesingle{}iwall\textquotesingle{}}\NormalTok{ slot }\StringTok{\textquotesingle{}int\textquotesingle{}}\NormalTok{ ...}
     \BuiltInTok{range}\NormalTok{ group }\StringTok{\textquotesingle{}wall\textquotesingle{}} \KeywordTok{or} \StringTok{\textquotesingle{}base\textquotesingle{}}
\OperatorTok{;}\NormalTok{ Want two different interfaces }\ControlFlowTok{for}\NormalTok{ proper normal direction at corner}
\NormalTok{zone interface }\StringTok{\textquotesingle{}side\textquotesingle{}}\NormalTok{ create by}\OperatorTok{{-}}\NormalTok{face }\BuiltInTok{range}\NormalTok{ group }\StringTok{\textquotesingle{}wall\textquotesingle{}} \KeywordTok{and} \StringTok{\textquotesingle{}iwall\textquotesingle{}}
\NormalTok{zone interface }\StringTok{\textquotesingle{}base\textquotesingle{}}\NormalTok{ create by}\OperatorTok{{-}}\NormalTok{face }\BuiltInTok{range}\NormalTok{ group }\StringTok{\textquotesingle{}base\textquotesingle{}} \KeywordTok{and} \StringTok{\textquotesingle{}iwall\textquotesingle{}}
\OperatorTok{;}\NormalTok{ Save initial geometric state}
\NormalTok{model save }\StringTok{\textquotesingle{}geometry\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\hypertarget{properties}{%
\section{Properties}\label{properties}}

\begin{Shaded}
\begin{Highlighting}[]
\OperatorTok{;}\NormalTok{ Initialize gravity, pore}\OperatorTok{{-}}\NormalTok{pressures, density, }\KeywordTok{and}\NormalTok{ stres state}
\NormalTok{model gravity }\DecValTok{10}
\OperatorTok{;}\NormalTok{ water table information}
\NormalTok{zone water density }\DecValTok{1000}
\NormalTok{zone water plane origin (}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\OperatorTok{{-}}\FloatTok{5.5}\NormalTok{) normal (}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\OperatorTok{{-}}\DecValTok{1}\NormalTok{)}
\NormalTok{zone initialize density }\DecValTok{1230}
\NormalTok{zone initialize density }\DecValTok{1550} \BuiltInTok{range}\NormalTok{ group }\StringTok{\textquotesingle{}wetclay{-}s\textquotesingle{}} \OperatorTok{;}\NormalTok{ Wet density}
\OperatorTok{;}\NormalTok{ assign properties to the soil }\KeywordTok{and}\NormalTok{ interfaces }\OperatorTok{{-}}\NormalTok{ temporarily remove pile cap}
\NormalTok{zone cmodel assign mohr}\OperatorTok{{-}}\NormalTok{coulomb ...}
     \BuiltInTok{range}\NormalTok{ group }\StringTok{\textquotesingle{}clay\textquotesingle{}}
\NormalTok{zone }\BuiltInTok{property}\NormalTok{ bulk }\FloatTok{8.333e7}\NormalTok{  shear }\FloatTok{3.846e7}\NormalTok{  cohesion }\DecValTok{30000}\NormalTok{ fric }\DecValTok{0}\NormalTok{ ...}
     \BuiltInTok{range}\NormalTok{ group }\StringTok{\textquotesingle{}clay\textquotesingle{}}
\NormalTok{zone cmodel assign elastic                 }\BuiltInTok{range}\NormalTok{ group }\StringTok{\textquotesingle{}pile\textquotesingle{}}
\NormalTok{zone }\BuiltInTok{property}\NormalTok{ bulk }\FloatTok{8.333e7}\NormalTok{  shear }\FloatTok{3.846e7}  \BuiltInTok{range}\NormalTok{ group }\StringTok{\textquotesingle{}pile\textquotesingle{}}
\NormalTok{zone cmodel assign null                    }\BuiltInTok{range}\NormalTok{ group }\StringTok{\textquotesingle{}remove{-}s\textquotesingle{}}
\NormalTok{zone interface }\StringTok{\textquotesingle{}side\textquotesingle{}}\NormalTok{ node }\BuiltInTok{property}\NormalTok{ stiffness}\OperatorTok{{-}}\NormalTok{normal }\FloatTok{1e8}\NormalTok{ ...}
\NormalTok{                           stiffness}\OperatorTok{{-}}\NormalTok{shear }\FloatTok{1e8}\NormalTok{ friction }\DecValTok{20}\NormalTok{ cohesion }\DecValTok{30000}
\NormalTok{zone interface }\StringTok{\textquotesingle{}base\textquotesingle{}}\NormalTok{ node }\BuiltInTok{property}\NormalTok{ stiffness}\OperatorTok{{-}}\NormalTok{normal }\FloatTok{1e8}\NormalTok{ ...}
\NormalTok{                           stiffness}\OperatorTok{{-}}\NormalTok{shear }\FloatTok{1e8}\NormalTok{ friction }\DecValTok{20}\NormalTok{ cohesion }\DecValTok{30000}
\end{Highlighting}
\end{Shaded}

\hypertarget{b.c.-and-i.c.}{%
\section{B.C. and I.C.}\label{b.c.-and-i.c.}}

\begin{Shaded}
\begin{Highlighting}[]
\OperatorTok{;}\NormalTok{ boundary }\KeywordTok{and}\NormalTok{ initial stress conditions}
\NormalTok{zone face }\BuiltInTok{apply}\NormalTok{ velocity}\OperatorTok{{-}}\NormalTok{normal }\DecValTok{0} \BuiltInTok{range}\NormalTok{ group }\StringTok{\textquotesingle{}Bottom\textquotesingle{}}
\NormalTok{zone face }\BuiltInTok{apply}\NormalTok{ velocity}\OperatorTok{{-}}\NormalTok{normal }\DecValTok{0} \BuiltInTok{range}\NormalTok{ group }\StringTok{\textquotesingle{}East\textquotesingle{}} \KeywordTok{or} \StringTok{\textquotesingle{}West\textquotesingle{}}
\NormalTok{zone face }\BuiltInTok{apply}\NormalTok{ velocity}\OperatorTok{{-}}\NormalTok{normal }\DecValTok{0} \BuiltInTok{range}\NormalTok{ group }\StringTok{\textquotesingle{}North\textquotesingle{}} \KeywordTok{or} \StringTok{\textquotesingle{}South\textquotesingle{}}
\NormalTok{zone initialize}\OperatorTok{{-}}\NormalTok{stress ratio }\FloatTok{0.4286}
\NormalTok{zone interface }\StringTok{\textquotesingle{}side\textquotesingle{}}\NormalTok{ node initialize}\OperatorTok{{-}}\NormalTok{stresses}
\NormalTok{zone interface }\StringTok{\textquotesingle{}base\textquotesingle{}}\NormalTok{ node initialize}\OperatorTok{{-}}\NormalTok{stresses}
\end{Highlighting}
\end{Shaded}

\hypertarget{initial-equilibrium-1}{%
\section{Initial Equilibrium}\label{initial-equilibrium-1}}

\begin{Shaded}
\begin{Highlighting}[]
\OperatorTok{;}\NormalTok{ Solve to initial equilibrium}
\NormalTok{zone ratio local}
\NormalTok{model solve ratio }\FloatTok{1e{-}4}
\NormalTok{model save }\StringTok{\textquotesingle{}initial\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\hypertarget{alterations-1}{%
\section{Alterations}\label{alterations-1}}

\hypertarget{install-the-pile}{%
\subsection{install the pile}\label{install-the-pile}}

\begin{Shaded}
\begin{Highlighting}[]
\OperatorTok{;}\NormalTok{ install the pile}
\NormalTok{model restore }\StringTok{\textquotesingle{}initial\textquotesingle{}}
\NormalTok{zone cmodel assign elastic                          }\BuiltInTok{range}\NormalTok{ group }\StringTok{\textquotesingle{}pile\textquotesingle{}}
\NormalTok{zone }\BuiltInTok{property}\NormalTok{ bulk }\FloatTok{13.9e9}\NormalTok{ shear }\FloatTok{10.4e9}\NormalTok{ density }\DecValTok{2500} \BuiltInTok{range}\NormalTok{ group }\StringTok{\textquotesingle{}pile\textquotesingle{}}
\NormalTok{model solve ratio }\FloatTok{1e{-}4}
\NormalTok{model save }\StringTok{\textquotesingle{}install\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\hypertarget{vertical-loading}{%
\subsection{vertical loading}\label{vertical-loading}}

\begin{Shaded}
\begin{Highlighting}[]
\OperatorTok{;}\NormalTok{ vertical loading}
\NormalTok{zone initialize state }\DecValTok{0}
\NormalTok{zone gridpoint initialize displacement (}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{)}
\NormalTok{zone gridpoint initialize velocity     (}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{) }
\NormalTok{table }\StringTok{\textquotesingle{}ramp\textquotesingle{}}\NormalTok{ add ([}\KeywordTok{global}\NormalTok{.step],}\DecValTok{0}\NormalTok{) ([}\KeywordTok{global}\NormalTok{.step}\OperatorTok{+}\DecValTok{30000}\NormalTok{],}\OperatorTok{{-}}\FloatTok{5e{-}8}\NormalTok{) ...}
\NormalTok{      ([}\KeywordTok{global}\NormalTok{.step}\OperatorTok{+}\DecValTok{58000}\NormalTok{],}\OperatorTok{{-}}\FloatTok{5e{-}8}\NormalTok{) }\OperatorTok{;}\NormalTok{ Increase velocity applied to pile}
                                  \OperatorTok{;}\NormalTok{ over }\DecValTok{30}\NormalTok{,}\DecValTok{000}\NormalTok{ steps}
\NormalTok{zone face }\BuiltInTok{apply}\NormalTok{ velocity}\OperatorTok{{-}}\NormalTok{normal }\DecValTok{1}\NormalTok{ table }\StringTok{\textquotesingle{}ramp\textquotesingle{}} \BuiltInTok{range}\NormalTok{ group }\StringTok{\textquotesingle{}Top\textquotesingle{}}
\NormalTok{history interval }\DecValTok{250}
\NormalTok{zone history name }\StringTok{\textquotesingle{}disp\textquotesingle{}}\NormalTok{ displacement}\OperatorTok{{-}}\NormalTok{z position (}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{)}
\NormalTok{call }\StringTok{\textquotesingle{}load\textquotesingle{}}
\NormalTok{fish history name }\StringTok{\textquotesingle{}load\textquotesingle{}} \OperatorTok{@}\NormalTok{vert\_load}
\NormalTok{zone mechanical damping combined}
\NormalTok{model step }\DecValTok{58000}
\NormalTok{model save }\StringTok{\textquotesingle{}vertical{-}loading\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\hypertarget{vertical-then-lateral-loading}{%
\subsection{vertical then lateral loading}\label{vertical-then-lateral-loading}}

\begin{Shaded}
\begin{Highlighting}[]
\OperatorTok{;}\NormalTok{ vertical loading then lateral loading}
\NormalTok{model restore }\StringTok{\textquotesingle{}install\textquotesingle{}}
\NormalTok{zone initialize state }\DecValTok{0}
\NormalTok{zone gridpoint initialize displacement (}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{)}
\NormalTok{zone gridpoint initialize velocity     (}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{) }
\NormalTok{zone face }\BuiltInTok{apply}\NormalTok{ stress}\OperatorTok{{-}}\NormalTok{zz [}\OperatorTok{{-}}\FloatTok{1.0e5}\OperatorTok{/}\NormalTok{(math.pi}\OperatorTok{*}\FloatTok{0.3}\OperatorTok{*}\FloatTok{0.3}\NormalTok{)] }\BuiltInTok{range}\NormalTok{ group }\StringTok{\textquotesingle{}Top\textquotesingle{}}
\NormalTok{model solve ratio }\FloatTok{1e{-}4}
\NormalTok{model save }\StringTok{\textquotesingle{}lateral{-}load{-}start\textquotesingle{}}

\OperatorTok{;} \BuiltInTok{apply}\NormalTok{ lateral loading }\ImportTok{as}\NormalTok{ x}\OperatorTok{{-}}\NormalTok{velocity on cap}
\NormalTok{zone initialize state }\DecValTok{0}
\NormalTok{zone gridpoint initialize displacement (}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{)}
\NormalTok{zone gridpoint initialize velocity     (}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{) }
\NormalTok{zone face }\BuiltInTok{apply}\NormalTok{ velocity}\OperatorTok{{-}}\NormalTok{x }\FloatTok{1e{-}7} \BuiltInTok{range}\NormalTok{ group }\StringTok{\textquotesingle{}Top\textquotesingle{}}
\NormalTok{zone history name }\StringTok{\textquotesingle{}disp\textquotesingle{}}\NormalTok{ displacement}\OperatorTok{{-}}\NormalTok{x position }\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}
\NormalTok{call }\StringTok{\textquotesingle{}p{-}y\textquotesingle{}}\NormalTok{ suppress }\OperatorTok{;}\NormalTok{ Calculates p}\OperatorTok{{-}}\NormalTok{y curve }\ControlFlowTok{for}\NormalTok{ pile, when tot\_reac }\KeywordTok{is}\NormalTok{ called}
\AttributeTok{@make\_pydata}        \OperatorTok{;}\NormalTok{ Generate p}\OperatorTok{{-}}\NormalTok{y curve calculation data }
\AttributeTok{@output\_structure}   \OperatorTok{;}\NormalTok{ Sanity check of p}\OperatorTok{{-}}\NormalTok{y curve data }
\NormalTok{fish history name }\StringTok{\textquotesingle{}load\textquotesingle{}} \OperatorTok{@}\NormalTok{tot\_reac}
\NormalTok{model step }\DecValTok{416500}
\NormalTok{model save }\StringTok{\textquotesingle{}lateral{-}load\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=1\linewidth]{myfigureeeeee/i}

\newpage

\begin{savequote}
In spite of their obvious deficiencies and unreliability, pile driving
formulas still enjoy great popularity among practicing engineers,
because the use of these formulas reduces the design of pile foundations
to a very simple procedure. The price one pays for this artificial
simplification is very high.
\qauthor{Karl Terzaghi(1943)}\end{savequote}

\hypertarget{pull-tests}{%
\chapter{Pull-Tests}\label{pull-tests}}

\includegraphics[width=1\linewidth]{myfigureeeeee/j}
\#\# Problem Description
\emph{note: FISH function force is used to sum the raction forces and monitor nodal displacement generated by the pull-test}\\
\emph{note: free length of bolt that extends out of block + larger diameter}\\
Perfectly plastic behavior of grout = max cohesion is exceeded +post-peak weakening of shear bond strength\\
\emph{note: bond strength softening of the grout is defined with keyword coupling-cohesion-table (see Rockbolt Behavior)}\\
The relation btw shear disp. and cohesion weakening is prescribed\\
thru table cct. softening of friction of grout canbe defined using keyword coupling-friction-table.\\

\hypertarget{zones-2}{%
\section{Zones}\label{zones-2}}

\begin{Shaded}
\begin{Highlighting}[]
\OperatorTok{;} \OperatorTok{==================================================================}
\OperatorTok{;}\NormalTok{   Simulation of pull}\OperatorTok{{-}}\NormalTok{test }\ControlFlowTok{for}\NormalTok{ grouted reinforcement}
\OperatorTok{;}\NormalTok{   using modified pile elements }\OperatorTok{{-}}\NormalTok{ Softening of cohesion}
\OperatorTok{;} \OperatorTok{==================================================================}
\NormalTok{model new }
\NormalTok{fish automatic}\OperatorTok{{-}}\NormalTok{create off}
\NormalTok{model title }\StringTok{\textquotesingle{}Pull{-}test using modified pile elements {-} cohesion softening\textquotesingle{}}
\OperatorTok{;}\NormalTok{ Create a single rock block }\KeywordTok{and} \BuiltInTok{set}\NormalTok{ its material properties.}
\NormalTok{zone create brick size }\DecValTok{4} \DecValTok{4} \DecValTok{6}\NormalTok{ point }\DecValTok{1}\NormalTok{ (}\FloatTok{0.4}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{) point }\DecValTok{2}\NormalTok{ (}\DecValTok{0}\NormalTok{,}\FloatTok{0.4}\NormalTok{,}\DecValTok{0}\NormalTok{) ...}
\NormalTok{                             point }\DecValTok{3}\NormalTok{ (}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\FloatTok{0.6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{properties-1}{%
\section{Properties}\label{properties-1}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{zone cmodel assign elastic}
\NormalTok{zone }\BuiltInTok{property}\NormalTok{ bulk }\FloatTok{5e9}\NormalTok{ shear }\FloatTok{3e9}
\NormalTok{zone face }\BuiltInTok{apply}\NormalTok{ velocity}\OperatorTok{{-}}\NormalTok{normal }\FloatTok{0.0} \BuiltInTok{range}\NormalTok{ position}\OperatorTok{{-}}\NormalTok{z }\FloatTok{0.6}
\OperatorTok{;}\NormalTok{ Create a pile element }\KeywordTok{and}\NormalTok{ assign properties}
\NormalTok{struct pile create by}\OperatorTok{{-}}\NormalTok{line (}\FloatTok{0.2}\NormalTok{,}\FloatTok{0.2}\NormalTok{,}\FloatTok{0.1}\NormalTok{) (}\FloatTok{0.2}\NormalTok{,}\FloatTok{0.2}\NormalTok{,}\FloatTok{0.7}\NormalTok{) segments }\DecValTok{12}
\NormalTok{struct pile }\BuiltInTok{property}\NormalTok{ rockbolt}\OperatorTok{{-}}\NormalTok{flag on}
\NormalTok{struct pile }\BuiltInTok{property}\NormalTok{ young }\FloatTok{200e9}\NormalTok{ poisson }\FloatTok{0.25}\NormalTok{ cross}\OperatorTok{{-}}\NormalTok{sectional}\OperatorTok{{-}}\NormalTok{area }\FloatTok{5e{-}4}\NormalTok{ ...}
\NormalTok{                     perimeter }\FloatTok{0.08}
\NormalTok{struct pile }\BuiltInTok{property}\NormalTok{ tensile}\OperatorTok{{-}}\ControlFlowTok{yield}   \FloatTok{2.25e5}  \OperatorTok{;}\NormalTok{ ultimate tensile strength}
\NormalTok{struct pile }\BuiltInTok{property}\NormalTok{ moi}\OperatorTok{{-}}\NormalTok{y }\FloatTok{2.0e{-}8}\NormalTok{ moi}\OperatorTok{{-}}\NormalTok{z }\FloatTok{2.0e{-}8}\NormalTok{ moi}\OperatorTok{{-}}\NormalTok{polar }\FloatTok{4.0e{-}8} \OperatorTok{;} \FloatTok{0.25}\OperatorTok{*}\NormalTok{pi}\OperatorTok{*}\NormalTok{r}\OperatorTok{\^{}}\DecValTok{4}
\NormalTok{struct pile }\BuiltInTok{property}\NormalTok{ coupling}\OperatorTok{{-}}\NormalTok{cohesion}\OperatorTok{{-}}\NormalTok{shear }\FloatTok{1.75e5}\NormalTok{ ...}
\NormalTok{                     coupling}\OperatorTok{{-}}\NormalTok{stiffness}\OperatorTok{{-}}\NormalTok{shear }\FloatTok{1.12e7}
\NormalTok{struct pile }\BuiltInTok{property}\NormalTok{ coupling}\OperatorTok{{-}}\NormalTok{cohesion}\OperatorTok{{-}}\NormalTok{normal }\FloatTok{1.75e5}\NormalTok{ ...}
\NormalTok{                     coupling}\OperatorTok{{-}}\NormalTok{stiffness}\OperatorTok{{-}}\NormalTok{normal }\FloatTok{1.12e7}
\NormalTok{struct pile }\BuiltInTok{property}\NormalTok{ coupling}\OperatorTok{{-}}\NormalTok{cohesion}\OperatorTok{{-}}\NormalTok{table }\StringTok{\textquotesingle{}cct\textquotesingle{}}
\OperatorTok{;}\NormalTok{ change }\KeywordTok{in}\NormalTok{ cohesion }\ControlFlowTok{with}\NormalTok{ relative shear displacement}
\NormalTok{table }\StringTok{\textquotesingle{}cct\textquotesingle{}}\NormalTok{ add (}\DecValTok{0}\NormalTok{,}\FloatTok{1.75e5}\NormalTok{) (}\FloatTok{0.025}\NormalTok{,}\FloatTok{1.75e4}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{initial-equilibrium-2}{%
\section{Initial Equilibrium}\label{initial-equilibrium-2}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{struct node fix velocity}\OperatorTok{{-}}\NormalTok{x }\BuiltInTok{range}\NormalTok{ position}\OperatorTok{{-}}\NormalTok{z }\FloatTok{0.7}
\NormalTok{struct node initialize velocity}\OperatorTok{{-}}\NormalTok{x }\FloatTok{1e{-}6}\NormalTok{ local }\BuiltInTok{range}\NormalTok{ position}\OperatorTok{{-}}\NormalTok{z }\FloatTok{0.7}
\NormalTok{call }\StringTok{\textquotesingle{}pileforce\textquotesingle{}}\NormalTok{ suppress }\OperatorTok{;}\NormalTok{ FISH function calculates reaction force on zones}
\end{Highlighting}
\end{Shaded}

\hypertarget{alterations-2}{%
\section{Alterations}\label{alterations-2}}

\begin{Shaded}
\begin{Highlighting}[]
\OperatorTok{;}\NormalTok{ Set up histories }\ControlFlowTok{for}\NormalTok{ monitoring model behavior}
\NormalTok{history interval }\DecValTok{10}
\NormalTok{fish history name }\StringTok{\textquotesingle{}force\textquotesingle{}} \OperatorTok{@}\NormalTok{force}
\NormalTok{struct node history name }\StringTok{\textquotesingle{}disp\textquotesingle{}}\NormalTok{ displacement}\OperatorTok{{-}}\NormalTok{z position (}\FloatTok{0.2}\NormalTok{,}\FloatTok{0.2}\NormalTok{,}\FloatTok{0.7}\NormalTok{)}
\OperatorTok{;}\NormalTok{ Achieve a total displacement of }\FloatTok{4.0}\NormalTok{ cm}
\NormalTok{model cycle }\DecValTok{40000}
\OperatorTok{;}
\NormalTok{model save }\StringTok{\textquotesingle{}pull{-}5\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\hypertarget{some-other-notes}{%
\section{Some other notes}\label{some-other-notes}}

2.3. pull test with confinement ``Pulltest06.f3dat''
+modified pile logic.(see Behavior of Shear Coupling Springs) linear law is implemented.whereby reinforcement shear strength is defined as constant\\
\emph{(coupling-cohesion-shear)+ effective pressure}perimeter\emph{fric angle(coupling-friction-shear)}\\
This pressure dependence is activated automatically by issuing reinforcement properties(perimeter) and\\

2.5. pull test with tensile rupture ``Pulltest08.f3dat''
\emph{note: tensile-yield, tensile-failure-strain: for limiting axial yield force and limiting axial strain for rockbolt}

\newpage

\hypertarget{grid}{%
\chapter{Grid}\label{grid}}

\hypertarget{primitive-shapes}{%
\section{Primitive Shapes}\label{primitive-shapes}}

\includegraphics[width=1\linewidth]{myfigureeeeee/radial-cylinder}

\includegraphics[width=1\linewidth]{myfigureeeeee/radial-square}

\includegraphics[width=1\linewidth]{myfigureeeeee/example-FLAC3D-Model}

\emph{note: zone create generates primitive grid}\\
\emph{note: zone gridpoint create puts gridpoints at specific locations }\\
\emph{note: zone gridpoint merge ensures separate primitives are connected properly}\\
\emph{note: zone attach connects primitive meshes of different zone sizes.}\\

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{zone create radial}\OperatorTok{{-}}\NormalTok{cylinder size }\DecValTok{5} \DecValTok{10} \DecValTok{6} \DecValTok{12}\NormalTok{ fill}
\NormalTok{zone create radial}\OperatorTok{{-}}\NormalTok{cylinder size }\DecValTok{5} \DecValTok{10} \DecValTok{6} \DecValTok{12}\NormalTok{ ratio }\DecValTok{1} \DecValTok{1} \DecValTok{1} \DecValTok{5}
\NormalTok{each size }\KeywordTok{is}\NormalTok{ controlled by a ratio (geometric ratio of }\FloatTok{1.2}\NormalTok{ times preceding zone)}
\end{Highlighting}
\end{Shaded}

ex) 5 along innder radius of cylindrical tunnel,\\
10 along axis\\
6 along circumference of tunnel\\
12 between periphery of tunnel and outer boundary of model\\
\emph{note: size keyword defines the number of zones in the grid.}\\

keywords for zone create:\\
- dimension
- edge
- fill
- point (boundary dimensions)
- ratio (coarser toward edge)
- size

\hypertarget{several-primitive-shapes-connected}{%
\section{several primitive shapes connected:}\label{several-primitive-shapes-connected}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{zone create radial}\OperatorTok{{-}}\NormalTok{cylinder size }\DecValTok{5} \DecValTok{10} \DecValTok{6} \DecValTok{12}\NormalTok{ rat }\DecValTok{1} \DecValTok{1} \DecValTok{1} \FloatTok{1.2}\NormalTok{ ...}
\NormalTok{                           point }\DecValTok{0}\NormalTok{ (}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{) point }\DecValTok{1}\NormalTok{ (}\DecValTok{100}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{) ...}
\NormalTok{                           point }\DecValTok{2}\NormalTok{ (}\DecValTok{0}\NormalTok{,}\DecValTok{200}\NormalTok{,}\DecValTok{0}\NormalTok{) point }\DecValTok{3}\NormalTok{ (}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{100}\NormalTok{)}
\NormalTok{zone create radial}\OperatorTok{{-}}\NormalTok{tunnel size }\DecValTok{5} \DecValTok{10} \DecValTok{5} \DecValTok{12}\NormalTok{ rat }\DecValTok{1} \DecValTok{1} \DecValTok{1} \FloatTok{1.2}\NormalTok{ ...}
\NormalTok{                          point }\DecValTok{0}\NormalTok{ (}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{) point }\DecValTok{1}\NormalTok{ (}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\OperatorTok{{-}}\DecValTok{100}\NormalTok{) ...}
\NormalTok{                          point }\DecValTok{2}\NormalTok{ (}\DecValTok{0}\NormalTok{,}\DecValTok{200}\NormalTok{,}\DecValTok{0}\NormalTok{) point }\DecValTok{3}\NormalTok{ (}\DecValTok{100}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{)}
\OperatorTok{;}\NormalTok{ here, model boundary dimensions are }\DecValTok{100}\NormalTok{, }\DecValTok{200}\NormalTok{, }\DecValTok{100}
\OperatorTok{;}\NormalTok{ boundary coord are defined using point keyword}

\NormalTok{zone reflect dip }\DecValTok{90}\NormalTok{ dip}\OperatorTok{{-}}\NormalTok{direction }\DecValTok{270}\NormalTok{ origin (}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

this adds symmetric part.\\
\emph{note: The symmetry plane is a vertical plane (located by the dip, dip-direction, and origin keywords) coincident with the x = 0 plane. Note that dip angle (dip) and dip direction (dip-direction) assume that x corresponds to ``East,'' y to ``North'', and z to ``Up.''}\\

third option, the zone gridpoint create command, is available to position single points in the model region.\\
\emph{note: zone gridpoint create is used for positioning reference points of primitives }\\

During execution of a zone create command, a check is made for each boundary gridpoint against the boundary gridpoints of zones that already exist.\\
If two boundary gridpoints fall within a tolerance of 1 ? 10-7 (relative to the magnitude of the gridpoints position vector) of each other, they are assumed to be the same point,\\
If it is discovered that some gridpoints don't match, the zone gridpoint merge command can be used to merge these gridpoints after the zone create command has been applied.\\

Example: (zone attach) - Two unequal sub-grids

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{zone create brick size }\DecValTok{4} \DecValTok{4} \DecValTok{2}\NormalTok{ point }\DecValTok{0}\NormalTok{ (}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{) point }\DecValTok{1}\NormalTok{ (}\DecValTok{4}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{) ...}
\NormalTok{                             point }\DecValTok{2}\NormalTok{ (}\DecValTok{0}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{0}\NormalTok{) point }\DecValTok{3}\NormalTok{ (}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{2}\NormalTok{)}
\NormalTok{zone create brick size }\DecValTok{8} \DecValTok{8} \DecValTok{4}\NormalTok{ point }\DecValTok{0}\NormalTok{ (}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{2}\NormalTok{) point }\DecValTok{1}\NormalTok{ (}\DecValTok{4}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{2}\NormalTok{) ...}
\NormalTok{                             point }\DecValTok{2}\NormalTok{ (}\DecValTok{0}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{2}\NormalTok{) point }\DecValTok{3}\NormalTok{ (}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{4}\NormalTok{)}
\NormalTok{zone attach by}\OperatorTok{{-}}\NormalTok{face }\BuiltInTok{range}\NormalTok{ position}\OperatorTok{{-}}\NormalTok{z }\DecValTok{2}
\end{Highlighting}
\end{Shaded}

Example: (zone densify)

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{zone create brick size }\DecValTok{4} \DecValTok{4} \DecValTok{4}
\NormalTok{zone densify segments }\DecValTok{2} \BuiltInTok{range}\NormalTok{ position}\OperatorTok{{-}}\NormalTok{x }\DecValTok{2} \DecValTok{4}
\end{Highlighting}
\end{Shaded}

the first two command lines can be changed to
where zone densify segments 2 refines the upper zones (between the z-coordinate of 2 and 4) with the segment number of 2 on each edge.

\hypertarget{structural-element-operation}{%
\section{Structural Element Operation}\label{structural-element-operation}}

Creating a liner in the service tunnel

\begin{Shaded}
\begin{Highlighting}[]
\OperatorTok{;}\NormalTok{ liner}
\NormalTok{structure shell create by}\OperatorTok{{-}}\NormalTok{face }\BuiltInTok{range}\NormalTok{ cylinder ...}
\NormalTok{                                     end}\OperatorTok{{-}}\DecValTok{1}\NormalTok{ (}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\OperatorTok{{-}}\DecValTok{1}\NormalTok{) end}\OperatorTok{{-}}\DecValTok{2}\NormalTok{ (}\DecValTok{0}\NormalTok{,}\DecValTok{50}\NormalTok{,}\OperatorTok{{-}}\DecValTok{1}\NormalTok{) ...}
\NormalTok{                                     radius }\DecValTok{3}
\end{Highlighting}
\end{Shaded}

The liner contains 240 structural shell elements and is connected to the FLAC3D grid at 143 structural-node links. The grid with the liner is shown below.

\hypertarget{densifying-grid-by-specifying-max-size-length}{%
\section{Densifying grid by specifying max size length}\label{densifying-grid-by-specifying-max-size-length}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model new}
\NormalTok{zone create brick size }\DecValTok{4} \DecValTok{4} \DecValTok{4}
\NormalTok{plot }\StringTok{\textquotesingle{}Brick\textquotesingle{}}\NormalTok{ export bitmap filename }\StringTok{\textquotesingle{}densify3.png\textquotesingle{}}
\OperatorTok{;}
\NormalTok{zone densify local maximum}\OperatorTok{{-}}\NormalTok{length (}\FloatTok{0.5}\NormalTok{,}\FloatTok{0.5}\NormalTok{,}\FloatTok{0.4}\NormalTok{) }\BuiltInTok{range}\NormalTok{ position}\OperatorTok{{-}}\NormalTok{z }\DecValTok{2} \DecValTok{4}
\NormalTok{zone attach by}\OperatorTok{{-}}\NormalTok{face}
\OperatorTok{;}
\NormalTok{plot }\StringTok{\textquotesingle{}Brick\textquotesingle{}}\NormalTok{ export bitmap filename }\StringTok{\textquotesingle{}densify4.png\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

note that in the local z-direction, the maximum size length is 0.4. FLAC3D densifies the maximum length in this direction to be 1/3 (= 0.4)\\
The zone attach by-face command in this example is used to attach faces of sub-grids together rigidly to form a single grid\\

Always use the zone attach by-face command after the zone densify command if there are different numbers of gridpoints along faces of different zones.\\

\hypertarget{densify-a-grid-using-geometric-information}{%
\subsection{Densify a grid using geometric information}\label{densify-a-grid-using-geometric-information}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model new}
\NormalTok{zone create brick size }\DecValTok{10} \DecValTok{10} \DecValTok{10}
\OperatorTok{;}
\NormalTok{geometry }\BuiltInTok{set} \StringTok{"setA"}\NormalTok{ polygon create ...}
\NormalTok{                    by}\OperatorTok{{-}}\NormalTok{positions (}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{) ( }\DecValTok{5}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{) ( }\DecValTok{5}\NormalTok{,}\DecValTok{10}\NormalTok{, }\DecValTok{1}\NormalTok{) (}\DecValTok{0}\NormalTok{,}\DecValTok{10}\NormalTok{,}\DecValTok{1}\NormalTok{)}
\NormalTok{geometry }\BuiltInTok{set} \StringTok{"setA"}\NormalTok{ polygon create ...}
\NormalTok{                    by}\OperatorTok{{-}}\NormalTok{positions (}\DecValTok{5}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{) (}\DecValTok{10}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{5}\NormalTok{) (}\DecValTok{10}\NormalTok{,}\DecValTok{10}\NormalTok{, }\DecValTok{5}\NormalTok{) (}\DecValTok{5}\NormalTok{,}\DecValTok{10}\NormalTok{,}\DecValTok{1}\NormalTok{)}
\NormalTok{geometry }\BuiltInTok{set} \StringTok{"setB"}\NormalTok{ polygon create ...}
\NormalTok{                    by}\OperatorTok{{-}}\NormalTok{positions (}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{5}\NormalTok{) ( }\DecValTok{5}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{5}\NormalTok{) ( }\DecValTok{5}\NormalTok{,}\DecValTok{10}\NormalTok{, }\DecValTok{5}\NormalTok{) (}\DecValTok{0}\NormalTok{,}\DecValTok{10}\NormalTok{,}\DecValTok{5}\NormalTok{)}
\NormalTok{geometry }\BuiltInTok{set} \StringTok{"setB"}\NormalTok{ polygon create ...}
\NormalTok{                    by}\OperatorTok{{-}}\NormalTok{positions (}\DecValTok{5}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{5}\NormalTok{) (}\DecValTok{10}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{10}\NormalTok{) (}\DecValTok{10}\NormalTok{,}\DecValTok{10}\NormalTok{,}\DecValTok{10}\NormalTok{) (}\DecValTok{5}\NormalTok{,}\DecValTok{10}\NormalTok{,}\DecValTok{5}\NormalTok{)}
\NormalTok{plot }\StringTok{\textquotesingle{}Brick2\textquotesingle{}}\NormalTok{ export bitmap filename }\StringTok{\textquotesingle{}densify5.png\textquotesingle{}}

\NormalTok{zone densify segments }\DecValTok{2} \BuiltInTok{range}\NormalTok{ geometry}\OperatorTok{{-}}\NormalTok{space }\StringTok{"setA"} \BuiltInTok{set} \StringTok{"setB"}\NormalTok{ count }\DecValTok{1}
\NormalTok{zone attach by}\OperatorTok{{-}}\NormalTok{face}
\OperatorTok{;}
\NormalTok{plot }\StringTok{\textquotesingle{}Brick2\textquotesingle{}}\NormalTok{ export bitmap filename }\StringTok{\textquotesingle{}densify6.png\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\newpage

\hypertarget{syntax-and-grammar}{%
\chapter{Syntax and Grammar}\label{syntax-and-grammar}}

\hypertarget{introduction}{%
\section{Introduction}\label{introduction}}

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ itasca }\ImportTok{as}\NormalTok{ it}
\NormalTok{it.command(}\StringTok{"python{-}reset{-}state false"}\NormalTok{)}
\NormalTok{it.command(}\StringTok{"""}
\StringTok{model new}
\StringTok{zone create brick size 10 10 10}
\StringTok{zone cmodel assign elastic}
\StringTok{zone property density 2950 young 12e9 poisson 0.25}
\StringTok{cycle 1}
\StringTok{"""}\NormalTok{)}
\NormalTok{it.zone.count()}
\NormalTok{z}\OperatorTok{=}\NormalTok{it.zone.find(}\DecValTok{1}\NormalTok{)}
\BuiltInTok{print}\NormalTok{ z}
\NormalTok{z.pos()}
\NormalTok{volume\_sum }\OperatorTok{=} \FloatTok{0.0}
\ControlFlowTok{for}\NormalTok{ z }\KeywordTok{in}\NormalTok{ it.zone.}\BuiltInTok{list}\NormalTok{():}
\NormalTok{  volume\_sum }\OperatorTok{+=}\NormalTok{ z.vol()}

\BuiltInTok{print}\NormalTok{ volume\_sum}
\BuiltInTok{print}\NormalTok{ z.vol() }\OperatorTok{*}\NormalTok{ it.zone.count()}
\ControlFlowTok{assert}\NormalTok{ volume\_sum }\OperatorTok{==}\NormalTok{ z.vol() }\OperatorTok{*}\NormalTok{ it.zone.count()}

\NormalTok{z }\OperatorTok{=}\NormalTok{ it.zone.near ((}\DecValTok{5}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{5}\NormalTok{))}
\NormalTok{z.pos()}
\end{Highlighting}
\end{Shaded}

\hypertarget{zones-3}{%
\section{Zones}\label{zones-3}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{it.zone.count() }\CommentTok{\# 1000}
\NormalTok{z }\OperatorTok{=}\NormalTok{ it.zone.find(}\DecValTok{1}\NormalTok{)}
\ControlFlowTok{for}\NormalTok{ z }\KeywordTok{in}\NormalTok{ it.zone.}\BuiltInTok{list}\NormalTok{():}
\NormalTok{  z }\OperatorTok{=}\NormalTok{ it.zone.near((}\DecValTok{5}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{5}\NormalTok{))}
\NormalTok{z.pos()}
\NormalTok{z.vol()}
\end{Highlighting}
\end{Shaded}

\hypertarget{properties-2}{%
\section{Properties}\label{properties-2}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{z.props() }\KeywordTok{or}\NormalTok{ z.props()[}\StringTok{\textquotesingle{}bulk\textquotesingle{}}\NormalTok{]}
\NormalTok{z.prop(}\StringTok{\textquotesingle{}shear\textquotesingle{}}\NormalTok{)}
\NormalTok{z.set\_prop(}\StringTok{\textquotesingle{}bulk\textquotesingle{}}\NormalTok{, }\FloatTok{8.5e9}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{gridpoints}{%
\section{Gridpoints}\label{gridpoints}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gp }\OperatorTok{=}\NormalTok{ it.gridpoint.near((}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{))}
\ControlFlowTok{for}\NormalTok{ gp }\KeywordTok{in}\NormalTok{ it.gridpoint.}\BuiltInTok{list}\NormalTok{():}
\NormalTok{  total\_mass }\OperatorTok{=}\NormalTok{ gp.mass\_gravity()}
\NormalTok{z.vol()}\OperatorTok{*}\NormalTok{z.density()}\OperatorTok{*}\DecValTok{1000}
\end{Highlighting}
\end{Shaded}

\hypertarget{structural-elements}{%
\section{Structural Elements}\label{structural-elements}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{it.structure.}\BuiltInTok{list}\NormalTok{()}
\NormalTok{it.structure.find(}\DecValTok{1}\NormalTok{)}
\NormalTok{it.structure.near((}\DecValTok{0}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{))}
\NormalTok{it.structure.node.find(}\DecValTok{1}\NormalTok{)}
\NormalTok{s\_node.links()[}\DecValTok{0}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\hypertarget{extra-variables}{%
\section{Extra Variables}\label{extra-variables}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{z.set\_extra(}\DecValTok{1}\NormalTok{, }\FloatTok{1.23}\NormalTok{)}
\NormalTok{z.set\_extra(}\DecValTok{2}\NormalTok{, }\StringTok{"a test string"}\NormalTok{)}
\NormalTok{z.set\_extra(}\DecValTok{1}\NormalTok{, gp.pos())}
\end{Highlighting}
\end{Shaded}

\hypertarget{groups-and-b.c.}{%
\section{Groups and B.C.}\label{groups-and-b.c.}}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{if}\NormalTok{ z.group(}\StringTok{"default"}\NormalTok{) }\OperatorTok{==} \StringTok{"lower"}\NormalTok{:}
\NormalTok{  gp.set\_fix(}\DecValTok{0}\NormalTok{, }\VariableTok{True}\NormalTok{)}
\NormalTok{  gp.set\_fix(}\DecValTok{1}\NormalTok{, }\VariableTok{True}\NormalTok{)}
\NormalTok{  gp.set\_force\_load((}\FloatTok{1e6}\NormalTok{,}\FloatTok{2e6}\NormalTok{,}\FloatTok{1e6}\NormalTok{))}
\NormalTok{it.zone.near((}\DecValTok{5}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{5}\NormalTok{)).stress()}
\NormalTok{it.zone.near((}\DecValTok{5}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{5}\NormalTok{)).strain()}
\CommentTok{"""}
\end{Highlighting}
\end{Shaded}

\hypertarget{parameteric-studies}{%
\section{Parameteric Studies}\label{parameteric-studies}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{"*note: for modulus in [6e9, 8e9, 10e9, 12e9]:"}
\NormalTok{it.command(}\StringTok{"""}
\StringTok{model restore \textquotesingle{}before\_cycling\textquotesingle{}}
\StringTok{zone prop young }\SpecialCharTok{\{\}}
\StringTok{model solve}
\StringTok{"""}\NormalTok{.}\BuiltInTok{format}\NormalTok{(modulus))}
\NormalTok{vertical\_disp }\OperatorTok{=}\NormalTok{ it.gridpoint.near((}\DecValTok{5}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{10}\NormalTok{)).disp\_z()}
\BuiltInTok{print} \StringTok{"\textasciitilde{}\textasciitilde{}\textasciitilde{}"}\NormalTok{.}\BuiltInTok{format}\NormalTok{(modulus,vertical\_disp)}
\end{Highlighting}
\end{Shaded}

\hypertarget{results-1}{%
\section{Results}\label{results-1}}

As discussed in Reaching Equilibrium, we recommend you use the convergence
1.0 limit criteria when using the model solve command

Initially solving to a convergence of 100 or more and then
examining the response is good practice. Making isosurface plots of convergence
to see where the model is having trouble can give insight into where model
adjustments in the interest of efficiency are best placed.

In order to determine a collapse load, it is often better to use ``strain-controlled''
rather than ``stress-controlled'' boundary conditions (i.e., apply a constant
velocity and measure the reaction forces, rather than apply forces and measure
displacements).

\begin{Shaded}
\begin{Highlighting}[]
\OperatorTok{;}\NormalTok{ Solve}
\NormalTok{model solve convergence }\DecValTok{1}
\NormalTok{model factor}\OperatorTok{{-}}\NormalTok{of}\OperatorTok{{-}}\NormalTok{safety }\BuiltInTok{file} \StringTok{\textquotesingle{}slope3dfos\textquotesingle{}}\NormalTok{ associated convergence }\DecValTok{1}
\end{Highlighting}
\end{Shaded}

\hypertarget{measuring-time-of-calculation}{%
\subsection{Measuring time of calculation}\label{measuring-time-of-calculation}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{[}\KeywordTok{global}\NormalTok{ start }\OperatorTok{=}\NormalTok{ time.clock]}
\NormalTok{model step }\DecValTok{100}
\NormalTok{[}\KeywordTok{global}\NormalTok{ rate }\OperatorTok{=} \DecValTok{10} \OperatorTok{*}\NormalTok{ zone.num }\OperatorTok{/}\NormalTok{ (time.clock}\OperatorTok{{-}}\NormalTok{start) ]}
\NormalTok{[io.out(}\StringTok{\textquotesingle{}Calculation rate = \textquotesingle{}}\OperatorTok{+}\NormalTok{string(rate)}\OperatorTok{+}\StringTok{\textquotesingle{} kilo{-}zones/sec\textquotesingle{}}\NormalTok{)]}
\end{Highlighting}
\end{Shaded}

\hypertarget{setting-fish-variables}{%
\section{Setting FISH variables}\label{setting-fish-variables}}

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ itasca }\ImportTok{as}\NormalTok{ it}
\NormalTok{it.command(}\StringTok{\textquotesingle{}python{-}reset{-}state false\textquotesingle{}}\NormalTok{)}
\NormalTok{it.fish.}\BuiltInTok{set}\NormalTok{(}\StringTok{\textquotesingle{}x\textquotesingle{}}\NormalTok{, }\DecValTok{10}\NormalTok{)}
\NormalTok{x }\OperatorTok{=}\NormalTok{ it.fish.get(}\StringTok{\textquotesingle{}x\textquotesingle{}}\NormalTok{) yields }\DecValTok{10}
\end{Highlighting}
\end{Shaded}

\hypertarget{issuing-command}{%
\subsection{Issuing Command}\label{issuing-command}}

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ itasca }\ImportTok{as}\NormalTok{ it}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}
\NormalTok{data }\OperatorTok{=}\NormalTok{ np.loadtext(}\StringTok{\textquotesingle{}brick{-}data.txt\textquotesingle{}}\NormalTok{)}
\NormalTok{command\_template }\OperatorTok{=} \OperatorTok{;;;} 
\NormalTok{zone create brick}
\NormalTok{zone cmodel assign elastic}
\NormalTok{zone }\BuiltInTok{property}\NormalTok{ density \{density\} young \{young\} poisson \{poisson\}}
\OperatorTok{;;;}
\NormalTok{density }\OperatorTok{=}\NormalTok{ data[}\DecValTok{0}\NormalTok{]}
\NormalTok{young }\OperatorTok{=}\NormalTok{ data[}\DecValTok{1}\NormalTok{]}
\NormalTok{poisson }\OperatorTok{=}\NormalTok{ data[}\DecValTok{2}\NormalTok{]}

\NormalTok{command }\OperatorTok{=}\NormalTok{ command\_template.}\BuiltInTok{format}\NormalTok{(density}\OperatorTok{=}\NormalTok{density, young}\OperatorTok{=}\NormalTok{young, poisson}\OperatorTok{=}\NormalTok{poisson)}
\NormalTok{it.command(command)}
\end{Highlighting}
\end{Shaded}

\hypertarget{string}{%
\section{String}\label{string}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{"The value of x is \{:.2f\}"}\NormalTok{.}\BuiltInTok{format}\NormalTok{(}\FloatTok{0.3872}\NormalTok{)}
\CommentTok{"The value of x is \{:.2e\}"}\NormalTok{.}\BuiltInTok{format}\NormalTok{(}\FloatTok{0.3872}\NormalTok{)}
\CommentTok{"My name is Sasha"}
\CommentTok{"My name is \{\}"}\NormalTok{.}\BuiltInTok{format}\NormalTok{(}\StringTok{"Sasha"}\NormalTok{)}
\CommentTok{"My name is \{name\}"}\NormalTok{.}\BuiltInTok{format}\NormalTok{(name}\OperatorTok{=}\StringTok{"Sasha"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{fish-syntax}{%
\section{Fish Syntax}\label{fish-syntax}}

\hypertarget{use-of}{%
\subsection{Use of \ldots{}}\label{use-of}}

A complete FISH statement occupies one line. However, a line may be typed across two or more lines as long as each line but the ultimate is terminated with the continuation character ( \ldots{} ). Use of temporary variables as hinge points to concatenate lengthy formulas can also be handy. The following example shows how this can be done:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fish define long\_sum  }\OperatorTok{;}\NormalTok{example of a }\BuiltInTok{sum}\NormalTok{ of many things}
\NormalTok{    local temp }\OperatorTok{=}\NormalTok{ v1 }\OperatorTok{+}\NormalTok{ v2 }\OperatorTok{+}\NormalTok{ v3 }\OperatorTok{+}\NormalTok{ v4 }\OperatorTok{+}\NormalTok{ v5 }\OperatorTok{+}\NormalTok{ v6 }\OperatorTok{+}\NormalTok{ v7 }\OperatorTok{+}\NormalTok{ v8 }\OperatorTok{+}\NormalTok{ v9 }\OperatorTok{+}\NormalTok{ v10}
\NormalTok{    long\_sum }\OperatorTok{=}\NormalTok{ temp }\OperatorTok{+}\NormalTok{ v11 }\OperatorTok{+}\NormalTok{ v12 }\OperatorTok{+}\NormalTok{ v13 }\OperatorTok{+}\NormalTok{ v14 }\OperatorTok{+}\NormalTok{ v15}
\NormalTok{end}
\end{Highlighting}
\end{Shaded}

\hypertarget{variable-types}{%
\subsection{Variable Types}\label{variable-types}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model new}
\NormalTok{fish define types}
\NormalTok{    v1 }\OperatorTok{=} \DecValTok{2}
\NormalTok{    v2 }\OperatorTok{=} \FloatTok{3.4}
\NormalTok{    v3 }\OperatorTok{=} \StringTok{\textquotesingle{}Have a nice day\textquotesingle{}}
\NormalTok{    v4 }\OperatorTok{=}\NormalTok{ v1 }\OperatorTok{*}\NormalTok{ v2}
\NormalTok{    v5 }\OperatorTok{=}\NormalTok{ v3 }\OperatorTok{+} \StringTok{\textquotesingle{}, old chap\textquotesingle{}}
\NormalTok{    v6 }\OperatorTok{=}\NormalTok{ vector(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{)}
\NormalTok{    v7 }\OperatorTok{=}\NormalTok{ matrix(vector(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{))}
\NormalTok{    v8 }\OperatorTok{=}\NormalTok{ true}
\NormalTok{end}
\AttributeTok{@types}
\NormalTok{fish }\BuiltInTok{list}
\end{Highlighting}
\end{Shaded}

The resulting screen display looks like this:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{           Name    Value}
           \OperatorTok{{-}{-}{-}{-}{-}{-}{-}} \OperatorTok{{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\NormalTok{(function) types }\DecValTok{0}\NormalTok{ (integer)}
\NormalTok{           v1    }\DecValTok{2}\NormalTok{ (integer)}
\NormalTok{           v2    }\FloatTok{3.400000000000000e+00}\NormalTok{ (real)}
\NormalTok{           v3    }\StringTok{\textquotesingle{}Have a nice day\textquotesingle{}}\NormalTok{ (string)}
\NormalTok{           v4    }\FloatTok{6.800000000000000e+00}\NormalTok{ (real)}
\NormalTok{           v5    }\StringTok{\textquotesingle{}Have a nice day, old chap\textquotesingle{}}\NormalTok{ (string)}
\NormalTok{           v6    (}\FloatTok{1.000000000000000e+00}\NormalTok{,}\FloatTok{2.000000000000000e+00}\NormalTok{,}
                  \FloatTok{3.000000000000000e+00}\NormalTok{) (vector3)                [}\OperatorTok{**}\NormalTok{]}
\NormalTok{           v7    }\DecValTok{3}\NormalTok{ x }\DecValTok{1}\NormalTok{ (matrix)}
\NormalTok{           v8    true (boolean)}
\end{Highlighting}
\end{Shaded}

\hypertarget{traditional-for-loop-in-fish}{%
\subsection{Traditional for loop in FISH}\label{traditional-for-loop-in-fish}}

standard for loop is also available in FISH to provide for additionalloop control.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fish define xxx}
    \BuiltInTok{sum}  \OperatorTok{=} \DecValTok{0}
\NormalTok{    prod }\OperatorTok{=} \DecValTok{1}
\NormalTok{    loop }\ControlFlowTok{for}\NormalTok{ (n }\OperatorTok{=} \DecValTok{1}\NormalTok{, n }\OperatorTok{\textless{}=} \DecValTok{10}\NormalTok{, n }\OperatorTok{=}\NormalTok{ n }\OperatorTok{+} \DecValTok{1}\NormalTok{)}
        \BuiltInTok{sum}  \OperatorTok{=} \BuiltInTok{sum}  \OperatorTok{+}\NormalTok{ n}
\NormalTok{        prod }\OperatorTok{=}\NormalTok{ prod }\OperatorTok{*}\NormalTok{ n}
\NormalTok{    end\_loop}
\NormalTok{    io.out(}\StringTok{\textquotesingle{}The sum is \textquotesingle{}} \OperatorTok{+}\NormalTok{ string(}\BuiltInTok{sum}\NormalTok{) }\OperatorTok{+}\NormalTok{ ... }
           \StringTok{\textquotesingle{} and the product is \textquotesingle{}} \OperatorTok{+}\NormalTok{ string(prod))}
\NormalTok{end}
\AttributeTok{@xxx}
\end{Highlighting}
\end{Shaded}

\hypertarget{controlled-loop}{%
\subsubsection{Controlled loop}\label{controlled-loop}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model new}
\NormalTok{fish define xxx}
    \BuiltInTok{sum}  \OperatorTok{=} \DecValTok{0}
\NormalTok{    prod }\OperatorTok{=} \DecValTok{1}
\NormalTok{    loop n (}\DecValTok{1}\NormalTok{,}\DecValTok{10}\NormalTok{)}
        \BuiltInTok{sum}  \OperatorTok{=} \BuiltInTok{sum}  \OperatorTok{+}\NormalTok{ n}
\NormalTok{        prod }\OperatorTok{=}\NormalTok{ prod }\OperatorTok{*}\NormalTok{ n}
\NormalTok{    end\_loop}
\NormalTok{    io.out(}\StringTok{\textquotesingle{}The sum is \textquotesingle{}} \OperatorTok{+}\NormalTok{ string(}\BuiltInTok{sum}\NormalTok{) }\OperatorTok{+}\NormalTok{  ...}
           \StringTok{\textquotesingle{} and the product is \textquotesingle{}} \OperatorTok{+}\NormalTok{ string(prod))}
\NormalTok{end}
\AttributeTok{@xxx}
\end{Highlighting}
\end{Shaded}

In this case, the loop variable n is given successive values from 1 to 10, and the statements inside the loop (between the loop and endloop statements) are executed for each value. As mentioned, variable names or an arithmetic expression could be substituted for the numbers 1 or 10. Note that the exit statement can be used to break out of a FISH loop and the continue statement can be used to skip the remaining instructions in the loop, moving to the next sequence of the loop.

It is important to note that this formulation of looping is different from a for loop in most high-level programming languages. For instance, one cannot easily control the ending condition (i.e., loop from 1 to 10 excluding 10) or the incrementing mechanism (i.e., loop from 1 to 10 by twos or loop backward). A standard for loop is also available in FISH to provide for additional loop control.

\hypertarget{if-else-endif-construct}{%
\subsection{if else endif construct}\label{if-else-endif-construct}}

These statements allow conditional execution of FISH function segments; else and then are optional. The item test consists of one of the following symbols or symbol pairs:\\

= \# \textgreater{} \textless{} \textgreater= \textless=\\

The displayed value of abc in this example depends on the argument provided to abc when it is executed. You should experiment with different test symbols (e.g., replace \textgreater{} with \textless).

Until now, our FISH functions have been invoked from FLAC3D, either by using the sqaure brackets {[}{]} of inline FISH, by giving the function name prepended with the the @ character, or by using the fish list command. It is also possible to do the reverse, to give FLAC3D commands from within FISH functions. Most valid FLAC3D commands can be embedded between the following FISH statements:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model new}
\NormalTok{fish define abc(xx)}
    \ControlFlowTok{if}\NormalTok{ xx }\OperatorTok{\textgreater{}} \DecValTok{0}\NormalTok{ then }
\NormalTok{        abc }\OperatorTok{=} \DecValTok{33}
    \ControlFlowTok{else}
\NormalTok{        abc }\OperatorTok{=} \DecValTok{11}
\NormalTok{    end\_if}
\NormalTok{end}
\NormalTok{[abc(}\DecValTok{1}\NormalTok{)]}
\NormalTok{[abc(}\OperatorTok{{-}}\DecValTok{1}\NormalTok{)]}
\end{Highlighting}
\end{Shaded}

\hypertarget{arrays-and-maps}{%
\subsection{Arrays and Maps}\label{arrays-and-maps}}

It is often the case that one would like to store a list of objects that they will loop over in the future. These may be computed values from zones, for instance, or specific gridpoint pointers themselves. FISH has two containers to use in these circumstances, termed arrays and maps.

An array holds a list of FISH variables of any type that can be looped over or accessed by the integer index of the element of the array. Arrays can be multidimensional and do not resize dynamically. The simple example below shows how one can create an array of integers and then sum the values.

\hypertarget{array-example}{%
\subsubsection{Array example}\label{array-example}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model new}
\NormalTok{fish define array\_operation}
    \OperatorTok{;}\NormalTok{create }\KeywordTok{and}\NormalTok{ populate an array }\ControlFlowTok{with}\NormalTok{ products of }\DecValTok{2}
\NormalTok{    arr }\OperatorTok{=}\NormalTok{ array.create(}\DecValTok{10}\NormalTok{)}
\NormalTok{    loop local n(}\DecValTok{1}\NormalTok{,}\DecValTok{10}\NormalTok{)}
\NormalTok{        arr[n] }\OperatorTok{=} \DecValTok{2}\OperatorTok{*}\NormalTok{n}
\NormalTok{    end\_loop}
      
    \OperatorTok{;}\NormalTok{compute the }\BuiltInTok{sum} \KeywordTok{and}\NormalTok{ product of elements }\KeywordTok{in}\NormalTok{ the array}
    \BuiltInTok{sum} \OperatorTok{=} \DecValTok{0}
\NormalTok{    prod }\OperatorTok{=} \DecValTok{1}
\NormalTok{    local i }\OperatorTok{=} \DecValTok{1}
\NormalTok{    loop }\ControlFlowTok{while}\NormalTok{ (i }\OperatorTok{\textless{}=}\NormalTok{ array.size(arr,}\DecValTok{1}\NormalTok{))}
        \BuiltInTok{sum} \OperatorTok{=} \BuiltInTok{sum} \OperatorTok{+}\NormalTok{ arr[i]}
\NormalTok{        prod }\OperatorTok{=}\NormalTok{ prod }\OperatorTok{*}\NormalTok{ arr[i]}
\NormalTok{        i }\OperatorTok{=}\NormalTok{ i }\OperatorTok{+} \DecValTok{1}
\NormalTok{    end\_loop}
\NormalTok{    io.out(}\StringTok{\textquotesingle{}The sum is \textquotesingle{}} \OperatorTok{+}\NormalTok{ string(}\BuiltInTok{sum}\NormalTok{) }\OperatorTok{+}\NormalTok{ ...}
           \StringTok{\textquotesingle{} and the product is \textquotesingle{}} \OperatorTok{+}\NormalTok{ string(prod))}
\NormalTok{end}
\AttributeTok{@array\_operation}
\end{Highlighting}
\end{Shaded}

In this example, an array is created and filled with numbers. The loop while construct is used to loop over the array entries and the sum and product are computed and output.

A map, on the other hand, is an associative container, meaning that one can access the members of a map by an integer or string used to insert a value in the map. Maps can dynamically be resized and added to one another (appending maps together), and are the preferred constructs for storing lists of FISH variables for later access.

\hypertarget{map-example}{%
\subsubsection{Map example}\label{map-example}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model new}
\NormalTok{fish define map\_operation}
    \OperatorTok{;}\NormalTok{create }\KeywordTok{and}\NormalTok{ populate a }\BuiltInTok{map} \ControlFlowTok{with}\NormalTok{ products of }\DecValTok{2}
\NormalTok{    my\_map }\OperatorTok{=} \BuiltInTok{map}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{)}
\NormalTok{    loop local n(}\DecValTok{2}\NormalTok{,}\DecValTok{10}\NormalTok{)}
        \BuiltInTok{map}\NormalTok{.add(my\_map,n,}\DecValTok{2}\OperatorTok{*}\NormalTok{n)}
\NormalTok{    end\_loop}
      
    \OperatorTok{;}\NormalTok{compute the }\BuiltInTok{sum} \KeywordTok{and}\NormalTok{ product of elements }\KeywordTok{in}\NormalTok{ the }\BuiltInTok{map}
    \BuiltInTok{sum} \OperatorTok{=} \DecValTok{0}
\NormalTok{    prod }\OperatorTok{=} \DecValTok{1}
\NormalTok{    loop foreach n my\_map}
        \BuiltInTok{sum} \OperatorTok{=} \BuiltInTok{sum} \OperatorTok{+}\NormalTok{ n}
\NormalTok{        prod }\OperatorTok{=}\NormalTok{ prod }\OperatorTok{*}\NormalTok{ n}
\NormalTok{    end\_loop}
\NormalTok{    io.out(}\StringTok{\textquotesingle{}The sum is \textquotesingle{}} \OperatorTok{+}\NormalTok{ string(}\BuiltInTok{sum}\NormalTok{) }\OperatorTok{+}\NormalTok{ ...}
           \StringTok{\textquotesingle{} and the product is \textquotesingle{}} \OperatorTok{+}\NormalTok{ string(prod))}
\NormalTok{end}
\AttributeTok{@map\_operation}
\end{Highlighting}
\end{Shaded}

Unlike with arrays, maps can be looped through using the loop foreach construct. In this case, n is the value held in each map entry, not the integer name of the object in the map. Likewise, instead of using integers to insert objects into the map, one could use strings such as first, second, etc. This allows one to easily and efficiently store and access FISH variables by a user-defined name.

\hypertarget{fish-function}{%
\subsection{Fish Function}\label{fish-function}}

FISH functions to calculate bulk and shear moduli

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model new}
\NormalTok{fish define derive(y\_mod,p\_ratio)}
\NormalTok{    s\_mod }\OperatorTok{=}\NormalTok{ y\_mod }\OperatorTok{/}\NormalTok{ (}\FloatTok{2.0} \OperatorTok{*}\NormalTok{ (}\FloatTok{1.0} \OperatorTok{+}\NormalTok{ p\_ratio))}
\NormalTok{    b\_mod }\OperatorTok{=}\NormalTok{ y\_mod }\OperatorTok{/}\NormalTok{ (}\FloatTok{3.0} \OperatorTok{*}\NormalTok{ (}\FloatTok{1.0} \OperatorTok{{-}} \FloatTok{2.0} \OperatorTok{*}\NormalTok{ p\_ratio))}
\NormalTok{end}
\NormalTok{[derive(}\FloatTok{5e8}\NormalTok{,}\FloatTok{0.25}\NormalTok{)]}
\NormalTok{[b\_mod] }
\NormalTok{[s\_mod]}
\end{Highlighting}
\end{Shaded}

\newpage

\hypertarget{code-block}{%
\chapter{Code Block}\label{code-block}}

\hypertarget{some-code}{%
\section{Some Code}\label{some-code}}

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ itasca }\ImportTok{as}\NormalTok{ it}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}
\NormalTok{np.set\_printoptions(threshold}\OperatorTok{=}\DecValTok{20}\NormalTok{)}
\NormalTok{it.command(}\StringTok{"python{-}reset{-}state false"}\NormalTok{)}
\ImportTok{from}\NormalTok{ itasca }\ImportTok{import}\NormalTok{ zonearray }\ImportTok{as}\NormalTok{ za}
\ImportTok{from}\NormalTok{ itasca }\ImportTok{import}\NormalTok{ gridpointarray }\ImportTok{as}\NormalTok{ gpa}

\CommentTok{" GROUPS AND MASK ARRAYS "}
\NormalTok{it.command(}\StringTok{"zone group }\CharTok{\textbackslash{}"}\StringTok{lower}\CharTok{\textbackslash{}"}\StringTok{ range position{-}z 0 5"}\NormalTok{)}
\NormalTok{za.in\_group(}\StringTok{"lower"}\NormalTok{)}
\NormalTok{za.in\_group(}\StringTok{"lower"}\NormalTok{).}\BuiltInTok{sum}\NormalTok{(), }\StringTok{"zones in lower group."}
\NormalTok{corner\_mask }\OperatorTok{=} \BuiltInTok{reduce}\NormalTok{(np.logical\_and, (x}\OperatorTok{\textless{}}\DecValTok{3}\NormalTok{, y}\OperatorTok{\textless{}}\DecValTok{3}\NormalTok{, z}\OperatorTok{\textless{}}\DecValTok{3}\NormalTok{))}
\NormalTok{za.set\_group(corner\_mask, }\StringTok{"corner"}\NormalTok{, }\StringTok{"geometry"}\NormalTok{)}
\BuiltInTok{print}\NormalTok{ za.in\_group(}\StringTok{"corner"}\NormalTok{, }\StringTok{"geometry"}\NormalTok{).}\BuiltInTok{sum}\NormalTok{(), }\StringTok{"zones in corner group."}

\CommentTok{" GRIDPOINTS ARRAY FUNCTIONS "}
\NormalTok{gpos }\OperatorTok{=}\NormalTok{ gpa.pos()}
\NormalTok{gx, gy, gz }\OperatorTok{=}\NormalTok{ gpos.T}
\BuiltInTok{print}\NormalTok{ gz}
\NormalTok{f }\OperatorTok{=}\NormalTok{ gpa.fixity()}
\BuiltInTok{print}\NormalTok{ f}
\NormalTok{f[:,][gz}\OperatorTok{==}\DecValTok{0}\NormalTok{] }\OperatorTok{=} \VariableTok{True}\NormalTok{, }\VariableTok{True}\NormalTok{, }\VariableTok{True}
\BuiltInTok{print}\NormalTok{ f}
\NormalTok{gpa.set\_fixity(f)}

\NormalTok{top\_gridpoints }\OperatorTok{=}\NormalTok{ gz}\OperatorTok{==}\DecValTok{10}
\NormalTok{radial\_distance }\OperatorTok{=}\NormalTok{ np.sqrt((gx}\OperatorTok{{-}}\DecValTok{5}\NormalTok{)}\OperatorTok{**}\DecValTok{2}\OperatorTok{+}\NormalTok{(gy}\OperatorTok{{-}}\DecValTok{5}\NormalTok{)}\OperatorTok{**}\DecValTok{2}\NormalTok{)}
\NormalTok{central\_gridpoints }\OperatorTok{=}\NormalTok{ radial\_distance }\OperatorTok{\textless{}} \DecValTok{5}
\NormalTok{mask }\OperatorTok{=}\NormalTok{ np.logical\_and(top\_gridpoints, central\_gridpoints)}
\BuiltInTok{print} \StringTok{"boundary load applied to }\SpecialCharTok{\{\}}\StringTok{ gridpoints"}\NormalTok{.}\BuiltInTok{format}\NormalTok{(mask.}\BuiltInTok{sum}\NormalTok{())}
\NormalTok{fapp }\OperatorTok{=}\NormalTok{ gpa.force\_app()}
\BuiltInTok{print}\NormalTok{ fapp}
\NormalTok{fapp[:,}\DecValTok{2}\NormalTok{] }\OperatorTok{=}\NormalTok{ mask}\OperatorTok{*}\FloatTok{1e6}\OperatorTok{*}\NormalTok{(}\FloatTok{5.0}\OperatorTok{{-}}\NormalTok{radial\_distance)}\OperatorTok{/}\FloatTok{5.0}
\NormalTok{gpa.set\_force\_app(fapp)}

\BuiltInTok{print} \StringTok{"zone centroids: "}
\BuiltInTok{print}\NormalTok{ za.pos()}
\NormalTok{za.gridpoints()}
\NormalTok{za.faces()}
\NormalTok{za.ids()}
\BuiltInTok{print}\NormalTok{ za.neighbors()}

\CommentTok{" =========================================== "}
\CommentTok{" =================RESULTS=================== "}
\CommentTok{" =========================================== "}

\NormalTok{it.command(}\StringTok{"model solve"}\NormalTok{)}
\BuiltInTok{print} \StringTok{"gridpoint displacements:"}
\BuiltInTok{print}\NormalTok{ gpa.disp()}
\BuiltInTok{print} \StringTok{"gridpoint displacement magnitudes: "}
\NormalTok{mag }\OperatorTok{=}\NormalTok{ np.linalg.norm(gpa.disp(), axis}\OperatorTok{=}\DecValTok{1}\NormalTok{)}
\BuiltInTok{print}\NormalTok{ mag}
\NormalTok{max\_index }\OperatorTok{=}\NormalTok{ np.argmax(mag)}
\BuiltInTok{print} \StringTok{"Maximum displacement: }\SpecialCharTok{\{\}}\StringTok{ at location }\SpecialCharTok{\{\}}\StringTok{"}\NormalTok{.}\BuiltInTok{format}\NormalTok{(gpa.disp()[max\_index],}
\NormalTok{                                              gpa.pos()[max\_index])}

\BuiltInTok{print} \StringTok{"Vertical displacement along the vertical line x=5, y=5: from z=0 to z=10"}
\BuiltInTok{print}\NormalTok{ gpa.disp()[np.logical\_and(gx}\OperatorTok{==}\DecValTok{5}\NormalTok{, gy}\OperatorTok{==}\DecValTok{5}\NormalTok{)][:,}\DecValTok{2}\NormalTok{]}

\NormalTok{za.stress()}

\NormalTok{za.stress\_flat()}

\CommentTok{" =========================================== "}
\CommentTok{" =========REFERENCE EXAMPLES================ "}
\CommentTok{" =========================================== "}
\CommentTok{""" Some Numpy Operation Examples}
\CommentTok{np.array([1,2,3,4,5])}
\CommentTok{np.linspace(0,1,15)}
\CommentTok{np.zeros((4,4))}
\CommentTok{a = np.linspace(0,1,15)}
\CommentTok{b = np.ones\_like(a)}
\CommentTok{np.sin(a)}
\CommentTok{print a[0]}
\CommentTok{a[0] = 20.2}
\CommentTok{print a}
\CommentTok{c = np.array(((1,2,3),(4,5,6),(7,8,9),(10,11,12)))}
\CommentTok{print c}
\CommentTok{c[0][0]}
\CommentTok{c[:,0]}
\CommentTok{"""}
\CommentTok{""" SOME GRIDPOINTS EXAMPLES}
\CommentTok{z = it.zone.near((5,5,5))}
\CommentTok{print "central zone id: \{\}, position: \{\}".format(z.id(), z.pos())}

\CommentTok{for gp in z.gridpoints():}
\CommentTok{    print "gridpoint with id: \{\} at \{\}".format(gp.id(), gp.pos())}
\CommentTok{"""}
\end{Highlighting}
\end{Shaded}

\hypertarget{interface}{%
\section{Interface}\label{interface}}

Interfaces are most often created with the zone interface create by-face command:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{zone interface }\StringTok{\textquotesingle{}flt\textquotesingle{}}\NormalTok{ create by}\OperatorTok{{-}}\NormalTok{face separate }\BuiltInTok{range}\NormalTok{ position}\OperatorTok{{-}}\NormalTok{z }\DecValTok{5}
\NormalTok{zone interface }\StringTok{\textquotesingle{}flt\textquotesingle{}}\NormalTok{ node }\BuiltInTok{property}\NormalTok{ stiffness}\OperatorTok{{-}}\NormalTok{normal }\FloatTok{1e8}\NormalTok{ stiffness}\OperatorTok{{-}}\NormalTok{shear }\FloatTok{1e8}
\end{Highlighting}
\end{Shaded}

This command creates an interface named flt by separating all zone faces found
at z=5 and placing interface elements and nodes on one side. Contacts are found
(and forces generated) by interface nodes coming into contact with zone surface
faces that are not part of the interface itself.

\begin{figure}[H]
\includegraphics[width=1\linewidth]{myfigureeeeee/k} \caption{Code chunk syntax}\label{fig:unnamed-chunk-58}
\end{figure}

Every reference to an interface uses a name (like the table command) to indicate
which interface is being referred to

Interfaces in FLAC3D are one-sided objects. Interface elements are (in general) created attached to zone surface faces, which
in turn create interface nodes. All contact detection is between interface nodes and zone surface faces.

Most commonly, interfaces need to be created starting with a mesh that is
continuous. In that case, it is easiest to separate the mesh and create the
interfaces all in one command using the separate keyword (as shown in the
example above).

The new-side-origin keyword can be used to determine which
side of the separation interface elements are applied to. The side opposite the
location of the origin will be selected. In the example above, to select the other
side, change the command to

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{zone interface }\StringTok{\textquotesingle{}flt\textquotesingle{}}\NormalTok{ create by}\OperatorTok{{-}}\NormalTok{face separate new}\OperatorTok{{-}}\NormalTok{side}\OperatorTok{{-}}\NormalTok{origin (}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{10}\NormalTok{) ...}
\BuiltInTok{range}\NormalTok{ position}\OperatorTok{{-}}\NormalTok{z }\DecValTok{5}
\end{Highlighting}
\end{Shaded}

\hypertarget{penetration}{%
\subsection{Penetration}\label{penetration}}

the calculation of normal stress due
to interface penetration is absolute instead of incremental. This means that
moving a gridpoint relative to an interface in the normal direction will have an
immediate effect on the normal stress calculated. This is not true of accumulated
shear stress, which remains incremental.

In small-strain mode, gridpoints do not actually move their location in response
to accumulated velocities.

small-displacement'' field. is a vector field
that is accumulated from the velocity field every step in small-strain mode only.
For the purposes of calculating interface penetration, a gridpoint location is
based on the current location plus the small-strain displacement. The smallstrain displacement may be initialized using the zone gridpoint initialize
displacement-small command, and this is sometimes useful to reset the effective
penetration of an interface after some grid motion.
To initialize interface stresses without actually moving gridpoints, we introduce
a normal stress increment that is added to the normal stress calculated from
absolute penetration. It is this value that is set when the zone interface node
initialize-stresses command is given. It can also be set explicitly using zone
interface node stress-normal-increment.

Spatial Variation and Randomness of Property Distribution

Material properties can be specified to adjust or to vary as a function of grid
position. In fact, a different property can be assigned to every zone in a FLAC3D
model, regardless of model size.
There are two commands avialable in FLAC3D to specfiy material properties. The
first, zone property, allows multiple properties to be specified in a single
command. This is convenient to completely specify properties in different
regions, where that property does not vary within that region.
The second can only specify one property at a time, but has optional keywords
that allow the property value to be automatically varied in space. This is the zone
property-distribution command. Among the available keywords are add,
multiply, gradient, and vary, which can be used to provide fixed or linear
variations of properties with position. For example, the following command
provides a linear variation of cohesion in the x-direction:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{zone }\BuiltInTok{property}\OperatorTok{{-}}\NormalTok{distribution cohesion }\FloatTok{1e6}\NormalTok{ gradient (}\OperatorTok{{-}}\FloatTok{1e5}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

An initial profile of a property can also be assigned via FISH.
With FLAC3D, it is also possible to study the influence of nonhomogeneity in a
material. Any type of statistical property distribution can be introduced, as each
element may have a unique property value. Two optional keywords are available
to apply a random distribution of a selected property with the zone propertydistribution command. The keyword deviation-gaussian assumes a normal
(Gaussian) distribution for the property, with a mean value, v, and standard
deviation, s. The keyword deviation-uniform assumes a uniform distribution with
mean value, v, and standard deviation, s. Be careful to ensure that properties do
not acquire negative values if s is large. As an example, the following command
would give a mean friction angle of 40° with a standard deviation of ±5\%:
zone property-distribution friction 45 deviation-gaussian 2
Use of the variation keywords in any command (not just for property variation) is
defined in the topic Value Modifiers (Add, Multiply, Gradient, Vary).

\hypertarget{kaist-model-1}{%
\section{KAIST Model}\label{kaist-model-1}}

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ itasca }\ImportTok{as}\NormalTok{ it}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}
\NormalTok{np.set\_printoptions(threshold}\OperatorTok{=}\DecValTok{20}\NormalTok{)}
\NormalTok{it.command(}\StringTok{"python{-}reset{-}state false"}\NormalTok{)}
\ImportTok{from}\NormalTok{ itasca }\ImportTok{import}\NormalTok{ zonearray }\ImportTok{as}\NormalTok{ za}
\ImportTok{from}\NormalTok{ itasca }\ImportTok{import}\NormalTok{ gridpointarray }\ImportTok{as}\NormalTok{ gpa}

\CommentTok{\# PARAMETERS \#}

\NormalTok{\_D\_shaft }\OperatorTok{=} \DecValTok{1}
\NormalTok{\_H\_shaft }\OperatorTok{=} \FloatTok{7.45}
\NormalTok{\_T\_plate }\OperatorTok{=} \FloatTok{1.5}
\NormalTok{\_B\_footing }\OperatorTok{=} \FloatTok{3.25}
\NormalTok{\_D\_footing }\OperatorTok{=}\NormalTok{ \_H\_shaft }\OperatorTok{+}\NormalTok{ \_T\_plate}
\NormalTok{\_B\_soil }\OperatorTok{=}\NormalTok{ \_B\_footing}\OperatorTok{*}\DecValTok{5}
\NormalTok{\_D\_soil }\OperatorTok{=}\NormalTok{ \_D\_footing}\OperatorTok{+}\DecValTok{3}

\NormalTok{\_radial }\OperatorTok{=} \DecValTok{50}
\NormalTok{\_perimeter }\OperatorTok{=} \DecValTok{2}\OperatorTok{*}\NormalTok{\_radial}
\NormalTok{\_axial }\OperatorTok{=} \DecValTok{2}\OperatorTok{*}\NormalTok{\_radial}
\NormalTok{\_outer }\OperatorTok{=} \DecValTok{2}\OperatorTok{*}\NormalTok{\_radial}

\NormalTok{\_bulk }\OperatorTok{=} \FloatTok{13.9e9}
\NormalTok{\_shear }\OperatorTok{=} \FloatTok{10.4e9}

\NormalTok{\_E\_o }\OperatorTok{=} \FloatTok{1e7}
\NormalTok{\_const }\OperatorTok{=} \FloatTok{1e8}
\NormalTok{\_poisson }\OperatorTok{=} \FloatTok{0.25}

\CommentTok{\# ZONE \#}

\NormalTok{command\_zone }\OperatorTok{=} \StringTok{"""}
\StringTok{model new}
\StringTok{z crea r{-}t p 0 (0,0,0) ...}
\StringTok{           p 1 (}\SpecialCharTok{\{B\_soil\}}\StringTok{,0,0) ... }
\StringTok{           p 2 (0,}\SpecialCharTok{\{D\_soil\}}\StringTok{,0) ...}
\StringTok{           p 3 (0,0,}\SpecialCharTok{\{B\_soil\}}\StringTok{) ...}
\StringTok{           p 4 (}\SpecialCharTok{\{B\_soil\}}\StringTok{,}\SpecialCharTok{\{D\_soil\}}\StringTok{,0) ...}
\StringTok{           p 5 (0,}\SpecialCharTok{\{D\_soil\}}\StringTok{,}\SpecialCharTok{\{B\_soil\}}\StringTok{) ...}
\StringTok{           p 6 (}\SpecialCharTok{\{B\_soil\}}\StringTok{,0,}\SpecialCharTok{\{B\_soil\}}\StringTok{) ...}
\StringTok{           p 7 (}\SpecialCharTok{\{B\_soil\}}\StringTok{,}\SpecialCharTok{\{D\_soil\}}\StringTok{,}\SpecialCharTok{\{B\_soil\}}\StringTok{) ...}
\StringTok{           p 8 (}\SpecialCharTok{\{B\_footing\}}\StringTok{,0,0) ...}
\StringTok{           p 9 (0,0,}\SpecialCharTok{\{B\_footing\}}\StringTok{) ...}
\StringTok{           p 10 (}\SpecialCharTok{\{B\_footing\}}\StringTok{,}\SpecialCharTok{\{D\_soil\}}\StringTok{,0) ...}
\StringTok{           p 11 (0,}\SpecialCharTok{\{D\_soil\}}\StringTok{,}\SpecialCharTok{\{B\_footing\}}\StringTok{) ...}
\StringTok{           p 12 (}\SpecialCharTok{\{B\_footing\}}\StringTok{,0,}\SpecialCharTok{\{B\_footing\}}\StringTok{) ...}
\StringTok{           p 13 (}\SpecialCharTok{\{B\_footing\}}\StringTok{,}\SpecialCharTok{\{D\_soil\}}\StringTok{,}\SpecialCharTok{\{B\_footing\}}\StringTok{) ...}
\StringTok{           size }\SpecialCharTok{\{radial\}}\StringTok{ }\SpecialCharTok{\{axial\}}\StringTok{ }\SpecialCharTok{\{perimeter\}}\StringTok{ }\SpecialCharTok{\{outer\}}\StringTok{ ...}
\StringTok{           rat 1 1 1 1.01 ...}
\StringTok{           fill}
\StringTok{"""}

\NormalTok{command }\OperatorTok{=}\NormalTok{ command\_zone.}\BuiltInTok{format}\NormalTok{(}
\NormalTok{B\_footing }\OperatorTok{=}\NormalTok{ \_B\_footing,}
\NormalTok{B\_soil }\OperatorTok{=}\NormalTok{ \_B\_soil,}
\NormalTok{D\_soil }\OperatorTok{=}\NormalTok{ \_D\_soil,}
\NormalTok{radial}\OperatorTok{=}\NormalTok{\_radial,}
\NormalTok{axial }\OperatorTok{=}\NormalTok{ \_axial,}
\NormalTok{perimeter }\OperatorTok{=}\NormalTok{ \_perimeter,}
\NormalTok{outer }\OperatorTok{=}\NormalTok{ \_outer)}

\NormalTok{it.command(command)}

\CommentTok{\# GROUP \#}

\NormalTok{p }\OperatorTok{=}\NormalTok{ za.pos()}
\NormalTok{x,y,z }\OperatorTok{=}\NormalTok{ p.T}
\BuiltInTok{print}\NormalTok{(it.zone.count(), }\StringTok{"zones in whole model"}\NormalTok{)}

\NormalTok{shaft }\OperatorTok{=} \BuiltInTok{reduce}\NormalTok{(np.logical\_and, (np.sqrt(x}\OperatorTok{**}\DecValTok{2}\OperatorTok{+}\NormalTok{z}\OperatorTok{**}\DecValTok{2}\NormalTok{)}\OperatorTok{\textless{}}\NormalTok{\_D\_shaft, y}\OperatorTok{\textless{}}\NormalTok{\_H\_shaft))}
\NormalTok{za.set\_group(shaft, }\StringTok{"shaft"}\NormalTok{) }\CommentTok{\# set the zones with shaft = true have "shaft" and "geometry"}
\BuiltInTok{print}\NormalTok{(za.in\_group(}\StringTok{"shaft"}\NormalTok{).}\BuiltInTok{sum}\NormalTok{(), }\StringTok{"zones in shaft group."}\NormalTok{) }\CommentTok{\#output how many zones are in the corner group}

\NormalTok{plate }\OperatorTok{=} \BuiltInTok{reduce}\NormalTok{(np.logical\_and, (x}\OperatorTok{\textless{}}\NormalTok{\_B\_footing,z}\OperatorTok{\textless{}}\NormalTok{\_B\_footing, y}\OperatorTok{\textgreater{}}\NormalTok{\_H\_shaft,y}\OperatorTok{\textless{}}\NormalTok{\_D\_footing))}
\NormalTok{za.set\_group(plate, }\StringTok{"plate"}\NormalTok{) }\CommentTok{\# set the zones with plate = true have "plate" and "geometry"}
\BuiltInTok{print}\NormalTok{(za.in\_group(}\StringTok{"plate"}\NormalTok{).}\BuiltInTok{sum}\NormalTok{(), }\StringTok{"zones in plate group."}\NormalTok{) }\CommentTok{\#output how many zones are in the corner group}

\CommentTok{\# CONSTITUTIVE MODEL \#}

\CommentTok{\#it.command("""}
\CommentTok{\#zone cmodel assign strain{-}softening range group "Radial Tunnel1"}
\CommentTok{\#zone property density 2500 bulk 2e8 shear 1e8 range group "Radial Tunnel1"}
\CommentTok{\#zone property cohesion 2e6 friction 45 tension 2e5 dilation 10 range group "Radial Tunnel1"}
\CommentTok{\#zone property table{-}friction \textquotesingle{}fri\textquotesingle{} table{-}cohesion \textquotesingle{}coh\textquotesingle{} table{-}dilation \textquotesingle{}dil\textquotesingle{} range group "Radial Tunnel1"}
\CommentTok{\#table \textquotesingle{}fri\textquotesingle{} add (0, 45) (.05, 42) (.1, 40) (1, 40)}
\CommentTok{\#table \textquotesingle{}coh\textquotesingle{} add (0,2e6) (.05,1e6) (.1,5e5) (1,5e5) }
\CommentTok{\#table \textquotesingle{}dil\textquotesingle{} add (0, 10) (.05,  3) (.1,  0)}
\CommentTok{\#""")}

\NormalTok{it.command(}\StringTok{"""}
\StringTok{zone cmodel assign elastic range group "Radial Tunnel1"}
\StringTok{zone cmodel assign elastic range group \textquotesingle{}shaft\textquotesingle{}}
\StringTok{zone cmodel assign elastic range group \textquotesingle{}plate\textquotesingle{}}

\StringTok{fish define fname(E\_o,const)}
\StringTok{loop foreach pnt zone.list}
\StringTok{z\_depth = zone.pos.y(pnt)}
\StringTok{E = E\_o+const*math.sqrt(z\_depth)}
\StringTok{zone.prop(pnt,\textquotesingle{}young\textquotesingle{})=E}
\StringTok{end\_loop}
\StringTok{end}
\StringTok{@fname(}\SpecialCharTok{\{E\_o\_\}}\StringTok{,}\SpecialCharTok{\{const\_\}}\StringTok{)}
\StringTok{zone property poisson }\SpecialCharTok{\{poisson\_\}}
\StringTok{plot item create zone contour property name \textquotesingle{}young\textquotesingle{}}
\StringTok{"""}\NormalTok{.}\BuiltInTok{format}\NormalTok{(E\_o\_}\OperatorTok{=}\NormalTok{\_E\_o,const\_}\OperatorTok{=}\NormalTok{\_const,poisson\_}\OperatorTok{=}\NormalTok{\_poisson))}

\NormalTok{it.command(}\StringTok{"""}
\StringTok{zone property bulk }\SpecialCharTok{\{bulk\}}\StringTok{  shear }\SpecialCharTok{\{shear\}}\StringTok{ range group \textquotesingle{}shaft\textquotesingle{}}
\StringTok{zone property bulk }\SpecialCharTok{\{bulk\}}\StringTok{  shear }\SpecialCharTok{\{shear\}}\StringTok{ range group \textquotesingle{}plate\textquotesingle{}}
\StringTok{"""}\NormalTok{.}\BuiltInTok{format}\NormalTok{(bulk}\OperatorTok{=}\NormalTok{\_bulk,shear}\OperatorTok{=}\NormalTok{\_shear))}

\CommentTok{\#soil = za.in\_group("Radial Tunnel1")}
\CommentTok{\# list(gp.list)}
\CommentTok{\# gp.isgroup(::gp.list,"North")}
\CommentTok{\# gp.force.unbal(::ad)}
\CommentTok{\# [ad = list(gp.list)(gp.isgroup(::gp.list,"North))]}
\end{Highlighting}
\end{Shaded}

\newpage

\hypertarget{theory}{%
\chapter{Theory}\label{theory}}

\hypertarget{interface-1}{%
\section{Interface}\label{interface-1}}

There are several instances in geomechanics in which it is desirable to represent planes on which sliding or separation can occur. For example:\\

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  joint, fault, or bedding planes in a geologic medium;
\item
  an interface between a foundation and the soil;
\item
  a contact plane between a bin or chute and the material that it contains;
\item
  a contact between two colliding objects; and
\item
  a planar ``barrier'' in space, which represents a fixed, non-deformable boundary at an arbitrary position and orientation.\\
\end{enumerate}

FLAC3D provides interfaces that are characterized by Coulomb sliding and/or tensile and shear bonding. Interfaces have the properties of friction, cohesion, dilation, normal and shear stiffnesses, and tensile and shear bond strength. Although there is no restriction on the number of interfaces or the complexity of their intersections, it is generally not reasonable to model more than a few simple interfaces with FLAC3D because it is awkward to specify complicated interface geometry. The program 3DEC (Itasca 2007) is specifically designed to model many interacting bodies in three dimensions; it should be used instead of FLAC3D for the more complicated interface problems.\\

Interfaces may also be used to join regions that have different zone sizes. In general, the zone attach command should be used to join grids together. However, in some circumstances, it may be more convenient to use an interface for this purpose. In this case, the interface is prevented from sliding or opening because it does not correspond to any physical entity.

\hypertarget{formulation}{%
\section{Formulation}\label{formulation}}

FLAC3D represents interfaces as collections of triangular elements (interface elements), each of which is defined by three nodes (interface nodes). Interface elements can be created at any location in space. Generally, interface elements are attached to a zone surface face; two triangular interface elements are defined for every quadrilateral zone face. Interface nodes are then created automatically at every interface element vertex. When another grid surface comes into contact with an interface element, the contact is detected at the interface node and is characterized by normal and shear stiffnesses, and sliding properties.\\

Each interface element distributes its area to its nodes in a weighted fashion. Each interface node has an associated representative area. The entire interface is thus divided into active interface nodes representing the total area of the interface. Figure 1 illustrates the relation between interface elements and interface nodes, and the representative area associated with an individual node.

\includegraphics[width=1\linewidth]{myfigureeeeee/interface-formulation}

It is important to note that interfaces are one-sided in FLAC3D. (This differs from the formulation of two-sided interfaces in two-dimensional FLAC (Itasca 2011).) It may be helpful to think of FLAC3D interfaces as ``shrink-wrap'' that is stretched over the desired surface, causing the surface to become sensitive to interpenetration with any other face with which it may come into contact.\\

The fundamental contact relation is defined between the interface node and a zone surface face, also known as the target face. The normal direction of the interface force is determined by the orientation of the target face.\\

During each timestep, the absolute normal penetration and the relative shear velocity are calculated for each interface node and its contacting target face. Both of these values are then used by the interface constitutive model to calculate a normal force and a shear-force vector. The constitutive model is defined by a linear Coulomb shear-strength criterion that limits the shear force acting at an interface node, normal and shear stiffnesses, tensile and shear bond strengths, and a dilation angle that causes an increase in effective normal force on the target face after the shear-strength limit is reached. By default, pore pressure is used in the interface effective stress calculation. This option can be activated/deactivated using the command zone interface effective command by setting effective = on/off. Figure 2 illustrates the components of the constitutive model acting at interface node (P):

\includegraphics[width=1\linewidth]{myfigureeeeee/interface-constitutive}

The normal and shear forces that describe the elastic interface response are determined at calculation time \((t + \Delta t)\) using the relations:

\[ F_n^{(t + \Delta t)} = k_n u_n A + \sigma_n A  \]
\[ F_{si}^{(t + \Delta t)} = F_{si}^{(t)} + k_s \Delta u_{si}^{(t + 0.5 \Delta t)} A + \sigma_{si} A\]

The inelastic interface logic works in the following way:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Bonded interface --- The interface remains elastic if stresses remain below the bond strengths; there is a shear bond strength, as well as a tensile bond strength. The normal bond strength is set using the tension interface property keyword. The command zone interface node property shear-bond-ratio = sbr sets the shear bond strength to sbr times the normal bond strength. The default value of property shear-bond-ratio (if not given) is 100.0. The bond breaks if either the shear stress exceeds the shear strength, or the tensile effective normal stress exceeds the normal strength. Note that giving property shear-bond-ratio alone does not cause a bond to be established---the tensile bond strength must also be set.\\
\item
  Slip while bonded --- An intact bond, by default, prevents all yield behavior (slip and separation). There is an optional property switch (bonded-slip) that causes only separation to be prevented if the bond is intact (but allows shear yield, under the control of the friction and cohesion parameters, using (F\_n) as the normal force). The command to allow/disallow slip for a bonded interface segment is zone interface node and by setting bonded-slip on or off.\\
\end{enumerate}

The default state of bonded-slip (if not given) is off.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  Coulomb sliding --- A bond is either intact or broken. If it is broken, then the behavior of the interface segment is determined by the friction and cohesion (and of course the stiffnesses). This is the default behavior, if bond strengths are not set (zero). A broken bond segment cannot take effective tension (which may occur under compressive normal force, if the pore pressure is greater). The shear force is zero (for a nonbonded segment) if the effective normal force is tensile or zero.\\
\end{enumerate}

The Coulomb shear-strength criterion limits the shear force by the relation:

\[ F_{smax} = c A + tan\phi (F_n - pA)\]
During sliding, shear displacement may cause an increase in the effective normal stress on the joint, according to the relation:

\[\sigma_n := \sigma_n + \frac{|F_s|_o - F_{smax}}{A k_s} tan\psi k_n\]

On printout (see the zone interface node list command ) the value of tension denotes whether a bond is intact or broken (or not set) --- nonzero or zero, respectively.\\

The normal and shear forces calculated at the interface nodes are distributed in equal and opposite directions to both the target face and the face to which the interface node is connected (the host face). Weighting functions are used to distribute the forces to the gridpoints on each face. The interface stiffnesses are added to the accumulated stiffnesses at gridpoints on both sides of the interface in order to maintain numerical stability.\\

Interface contacts are detected only at interface nodes, and contact forces are transferred only at interface nodes. The stress state associated with a node is assumed to be uniformly distributed over the entire representative area of the node. Interface properties are associated with each node; properties may vary from node to node.\\

By default, the effect of pore pressure is included in the interface calculation by using effective stress as the basis for the slip condition. (The interface pore pressure is interpolated from the target face.) This applies in model configure fluid mode, or if pore pressures are assigned with the zone water or zone gridpoint initialize pore-pressure command without specifying model configure fluid. The user can switch options for interface s by using the zone interface effective command and by setting effective on or off. By default in the FLAC3D logic, fluid flow (saturated or unsaturated) is carried across an interface, provided the interface keyword maximum-edge is not used for that particular interface. The permeable interface option can be deactivated/reactivated for interface s by using the zone interface permeability command and by setting effective on or off. Note that if the keyword maximum-edge is used after the zone interface element command, and permeability is on for a particular interface, a warning is issued to inform the user that this interface will be considered as impermeable to fluid flow. (Note that for fluid flow calculation only, a mechanical model must be present. Also, the model cycle 0 command with model mechanical active on should be used to initialize the weighting factors used to transfer fluid flow information across the interface.) No pressure drop normal to the joint and no influence of normal displacement on pore pressure is calculated.\\

Also, flow of fluid along the interface is not modeled.\\

\hypertarget{creation-of-interface-geometry}{%
\section{Creation of Interface Geometry}\label{creation-of-interface-geometry}}

Interfaces are created with the zone interface create command. For cases in which an interface between two separate grids in the model is required, the zone interface create by-face command should be used to attach an interface to one of the grid surfaces. This command generates interface elements for interface s along all surface zone faces with a center point that fall within a specified range. Any surfaces on which an interface is to be created must be generated initially; it must be possible to specify an existing surface in order to create the interface elements. A gap must be specified between two adjacent surfaces, unless the zone interface create by-face command and the separate keyword are given. In this case, the separate sub-grids may have surface gridpoints at the same location in space.\\

By default, two interface elements are created for each zone face. The number of interface elements can be increased by using the zone interface s element maximum-edge v command. {[}1{]} This causes all interface elements with edge lengths larger than v to subdivide into smaller elements until their lengths are smaller than v. This command can be used to increase the resolution and decrease arching of forces in portions of a model that have large contrasts in zone size across an interface.\\

Several rules should be followed when using interface elements in FLAC3D:\\

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  If a smaller surface area contacts a larger surface area (e.g., a small block resting on a large block), the interface should be attached to the smaller region.\\
\item
  If there is a difference in zone density between two adjacent grids, the interface should be attached to the grid with the greater zone density (i.e., the greater number of zones within the same area).
\item
  The size of interface elements should always be equal to or smaller than the target faces with which they will come into contact. If this is not the case, the interface elements should be subdivided into smaller elements.\\
\item
  Interface elements should be limited to grid surfaces that will actually come into contact with another grid.\\
  A simple example illustrating the procedure for interface creation is provided in ``DippingJoint.f3dat''. The corresponding project file, ``DippingJoint.f3prj'', is located in the folder ``datafiles InterfaceDippingJoint.'' The example is a block specimen containing a single joint dipping at an angle of \(45°\)
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\OperatorTok{;}\NormalTok{ Create interface elements on the top surface of the base        }
\NormalTok{zone interface }\StringTok{\textquotesingle{}joint\textquotesingle{}}\NormalTok{ create by}\OperatorTok{{-}}\NormalTok{face separate }\BuiltInTok{range}\NormalTok{ group }\StringTok{\textquotesingle{}Top\textquotesingle{}}\NormalTok{ group }\StringTok{\textquotesingle{}Base\textquotesingle{}}
\NormalTok{model save }\StringTok{\textquotesingle{}int1\textquotesingle{}}
\ControlFlowTok{return}
\end{Highlighting}
\end{Shaded}

\hypertarget{typical-properties}{%
\section{Typical Properties}\label{typical-properties}}

\includegraphics[width=1\linewidth]{myfigureeeeee/typical_dilation}

Post-Failure Properties
In many instances, particularly in mining engineering, the response of a material
after failure has initiated is an important factor in the engineering design.
Consequently, the post-failure behavior must be simulated in the material
model. In FLAC3D, this is accomplished with properties that define four types of
post failure response:
1. shear dilatancy;
2. shear hardening/softening;
3. volumetric hardening/softening; and
4. tensile softening.
These properties are only activated after failure is initiated, as defined by the
Mohr-Coulomb relation or the tensile-failure criterion. Shear dilatancy is
simulated with the Mohr-Coulomb, ubiquitous-joint and strain-softening MohrCoulomb and ubiquitous-joint models. Shear hardening/softening is simulated
with the strain-softening Mohr-Coulomb and ubiquitous-joint models, and
volumetric hardening/softening is simulated with the modified Cam-clay model.
Tensile softening is simulated with the strain-softening Mohr-Coulomb and
ubiquitous-joint models

\hypertarget{shear-dilatancy}{%
\subsection{Shear Dilatancy}\label{shear-dilatancy}}

\includegraphics[width=1\linewidth]{myfigureeeeee/dil}
Shear dilatancy, or dilatancy, is the change in volume that occurs with shear
distortion of a material. Dilatancy is characterized by a dilation angle, , which is
related to the ratio of plastic volume change to plastic shear strain. This angle
can be specified in the Mohr-Coulomb ubiquitous-joint and strain-hardening/
softening models in FLAC3D. Dilation angle is typically determined from triaxial
tests or shear-box tests. For example, the idealized relation for dilatancy, based
upon the Mohr-Coulomb failure surface, is depicted for a triaxial test in the
figure below. The dilation angle is found from the plot of volumetric strain
versus axial strain. Note that the initial slope for this plot corresponds to the
elastic regime, while the slope used to measure the dilation angle corresponds to
the plastic regime

\includegraphics[width=1\linewidth]{myfigureeeeee/typical_angles}
Selected Strength Properties (drained, laboratory-scale) for Soils (Ortiz
et al.~1980)

\includegraphics[width=1\linewidth]{myfigureeeeee/typical_sand}

\hypertarget{compression-test-on-strain-softening-material}{%
\subsection{Compression Test on strain-softening material}\label{compression-test-on-strain-softening-material}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model new}
\OperatorTok{;}\NormalTok{ Create zones}
\NormalTok{zone create cylinder point }\DecValTok{0}\NormalTok{ (}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{) point }\DecValTok{1}\NormalTok{ (}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{) point }\DecValTok{2}\NormalTok{ (}\DecValTok{0}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{0}\NormalTok{) ...}
\NormalTok{point }\DecValTok{3}\NormalTok{ (}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{) size }\DecValTok{4} \DecValTok{5} \DecValTok{4}
\NormalTok{zone reflect normal (}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{)}
\NormalTok{zone reflect normal (}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{)}
\OperatorTok{;}\NormalTok{ Constitutive Model }\KeywordTok{and}\NormalTok{ properties}
\NormalTok{zone cmodel assign strain}\OperatorTok{{-}}\NormalTok{softening}
\NormalTok{zone }\BuiltInTok{property}\NormalTok{ bulk }\FloatTok{1.19e10}\NormalTok{ shear }\FloatTok{1.1e10}
\NormalTok{zone }\BuiltInTok{property}\NormalTok{ cohesion }\FloatTok{2.72e5}\NormalTok{ friction }\DecValTok{44}\NormalTok{ tension }\FloatTok{2e5}
\NormalTok{zone }\BuiltInTok{property}\NormalTok{ table}\OperatorTok{{-}}\NormalTok{cohesion }\StringTok{\textquotesingle{}coh\textquotesingle{}}\NormalTok{ table}\OperatorTok{{-}}\NormalTok{friction }\StringTok{\textquotesingle{}fri\textquotesingle{}}
\NormalTok{table }\StringTok{\textquotesingle{}coh\textquotesingle{}}\NormalTok{ add (}\DecValTok{0}\NormalTok{,}\FloatTok{2.72e5}\NormalTok{) (}\FloatTok{1e{-}4}\NormalTok{,}\FloatTok{2e5}\NormalTok{) (}\FloatTok{2e{-}4}\NormalTok{,}\FloatTok{1.5e5}\NormalTok{) (}\FloatTok{3e{-}4}\NormalTok{,}\FloatTok{1.03e5}\NormalTok{) (}\DecValTok{1}\NormalTok{,}\FloatTok{1.03e5}\NormalTok{)}
\NormalTok{table }\StringTok{\textquotesingle{}fri\textquotesingle{}}\NormalTok{ add (}\DecValTok{0}\NormalTok{,}\DecValTok{44}\NormalTok{) (}\FloatTok{1e{-}4}\NormalTok{,}\DecValTok{42}\NormalTok{) (}\FloatTok{2e{-}4}\NormalTok{,}\DecValTok{40}\NormalTok{) (}\FloatTok{3e{-}4}\NormalTok{,}\DecValTok{38}\NormalTok{) (}\DecValTok{1}\NormalTok{,}\DecValTok{38}\NormalTok{)}
\OperatorTok{;}\NormalTok{ Boundary Conditions}
\NormalTok{zone face }\BuiltInTok{apply}\NormalTok{ velocity (}\DecValTok{0}\NormalTok{, }\FloatTok{1e{-}7}\NormalTok{,}\DecValTok{0}\NormalTok{) }\BuiltInTok{range}\NormalTok{ position}\OperatorTok{{-}}\NormalTok{y }\DecValTok{0}
\NormalTok{zone face }\BuiltInTok{apply}\NormalTok{ velocity (}\DecValTok{0}\NormalTok{,}\OperatorTok{{-}}\FloatTok{1e{-}7}\NormalTok{,}\DecValTok{0}\NormalTok{) }\BuiltInTok{range}\NormalTok{ position}\OperatorTok{{-}}\NormalTok{y }\DecValTok{2}
\OperatorTok{;}\NormalTok{ Histories}
\NormalTok{zone history displacement}\OperatorTok{{-}}\NormalTok{y position (}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{)}
\NormalTok{zone history stress}\OperatorTok{{-}}\NormalTok{yy position (}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{)}
\NormalTok{zone history stress}\OperatorTok{{-}}\NormalTok{yy position (}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{)}
\NormalTok{model step }\DecValTok{3000}
\NormalTok{model save }\StringTok{\textquotesingle{}Softening\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

The horizontal stress-displacement response is monitored again, as shown in
the image below. This test produces distinct peak and residual failure stress
levels

\includegraphics[width=1\linewidth]{myfigureeeeee/softening}

The strain-softening model assumes both a brittle softening (due to reduction in
cohesion) and a gradual softening (due to a reduction in friction angle). The
selection of the properties is discussed further in Material Properties.
Comparison of the two images above illustrates the different responses of the
two models. The initial response up to the onset of failure is identical, but postfailure behavior is quite different. Clearly, more data are required to use the
strain-softening model and, typically, the softening model must be calibrated for
each specific problem.

\hypertarget{command}{%
\chapter{Command}\label{command}}

\hypertarget{interface-2}{%
\section{Interface}\label{interface-2}}

\hypertarget{zone-face-group}{%
\subsection{zone face group}\label{zone-face-group}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{zone face group s keyword ... }\OperatorTok{\textless{}}\BuiltInTok{range}\OperatorTok{\textgreater{}} 
\end{Highlighting}
\end{Shaded}

Example:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{zone face group }\StringTok{\textquotesingle{}wall\textquotesingle{}}\NormalTok{ internal }\BuiltInTok{range}\NormalTok{ group }\StringTok{\textquotesingle{}wall{-}c\textquotesingle{}}\NormalTok{ group }\StringTok{\textquotesingle{}pile\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

Adds a group name `wall' to zone faces included in the optional range.
Also can be used with zone face group ``slotname = groupname''
Zone face may belong to many groups, up to 128.
keywords: internal, or, remove.\\
- internal: to select all faces.\\
If specified, then the range looks at internal faces as well as surface faces.

\begin{itemize}
\item
  or: considered inside the surface if any of those conditions has a non-null model.
\item
  remove: group is removed from the zone face.
\end{itemize}

\hypertarget{zone-face-skin}{%
\subsection{zone face skin}\label{zone-face-skin}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{zone face skin}
\end{Highlighting}
\end{Shaded}

Generates contiguous face groups by skinning.

``skinning'' refers to automatic face group generation, which occurs as follows: the program looks for contiguous faces and puts them into automatically named groups within the slot named skin. Two faces are not considered contiguous if the angle between two faces exceeds the break angle, or if the two faces belong to different groups according to the command's slot specification.
Unless internal is specified, the operation of zone face skin is restricted to external faces. Only zone faces that have no zone on the other side, a hidden zone on the other side are considered surface faces.
When use-hidden-zones is used, within specified range will be included for consideration.

group names are generated as follows:
sEast, sWest, sNorth, sSouth, sTop, sBottom

Internal faces are assigned names of the group on either side that changed in order to create them.

\hypertarget{zone-separate}{%
\subsection{zone separate}\label{zone-separate}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{zone separete by}\OperatorTok{{-}}\NormalTok{face new}\OperatorTok{{-}}\NormalTok{side group }\StringTok{\textquotesingle{}iwall\textquotesingle{}}\NormalTok{ slot }\StringTok{\textquotesingle{}int\textquotesingle{}} \BuiltInTok{range}\NormalTok{ group }\StringTok{\textquotesingle{}wall\textquotesingle{}} \KeywordTok{or} \StringTok{\textquotesingle{}base\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

separates internal faces specified by the range. The gridpoints of the face are duplicated, and new face is created. New faces and gridpoints get copies of all group and extra variable assignments belonging to the original face and gridpoint.

Example:
If Fred and George are group names assigned to zones, then

\begin{Shaded}
\begin{Highlighting}[]
\BuiltInTok{range}\NormalTok{ group }\StringTok{\textquotesingle{}Fred\textquotesingle{}}\NormalTok{ group }\StringTok{\textquotesingle{}George\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

will select faces that are connected to zone of both group Fred and George.

keyword:
- by-face: attempts to separate all internal faces in the range
- new-side group: newly created faces will be assigned the group name in the specified slot.
The default slot, is named Default.

\hypertarget{zone-interface-create}{%
\subsection{zone interface create}\label{zone-interface-create}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{zone interface }\StringTok{\textquotesingle{}side\textquotesingle{}}\NormalTok{ create by}\OperatorTok{{-}}\NormalTok{face }\BuiltInTok{range}\NormalTok{ group }\StringTok{\textquotesingle{}wall\textquotesingle{}} \KeywordTok{and} \StringTok{\textquotesingle{}iwall\textquotesingle{}}

\NormalTok{zone interface }\StringTok{\textquotesingle{}side\textquotesingle{}}\NormalTok{ node }\BuiltInTok{property}\NormalTok{ stiffness}\OperatorTok{{-}}\NormalTok{normal }\FloatTok{1e8}\NormalTok{ stiffness}\OperatorTok{{-}}\NormalTok{shear }\FloatTok{1e8}\NormalTok{ friction }\DecValTok{20}\NormalTok{ cohesion }\DecValTok{30000}
\end{Highlighting}
\end{Shaded}

creates nodes or elements on interface side

There are two techniques for creating an interface.
1. To derive an interface from a range of zone faces using by-face keyword.
2. To specify a triangular interface element from 3 points.
3. Command may also be used to construct an interface node that may be used with the element keyword.

keyword:
- by-face: interface elements are created on all surface zone faces that are within the specified range. An error will occur if interface elements from that interface already exist on the selected faces.
If the optional separate keyword is used, then internal zone faces are selected by the range. The list of selected faces is then automatically separated (as with zone separate) and interface elements placed on one side. The following are for the separate keyword: new-side-origin, clear-attach.

\begin{itemize}
\tightlist
\item
  element point i keyword \ldots{} : create a triangular interface element by specifying 3 points. Three verticies must be specified by the following keyword. Each point can be created and located in space using the position keyword, or an existing interface node with ID i may be specified. The interface element that is created is not attached to a grid face even if the location corresponds to that of the face. the element is fixed in space. The active side of the element is defined by walking around the edge of the element, from point 1 to point 2 to point 3; the active side is up when walking in a clockwise direction.
\end{itemize}

For each point of the element, one of the following two keywords must be supplied: node i, position v.

\begin{itemize}
\tightlist
\item
  node v : this creates an interface node at position v. If a node already exists at the selected location, an error is reported. The created node is fixed in space.
\end{itemize}

\startappendices

\hypertarget{template}{%
\chapter{1. Template}\label{template}}

\hypertarget{problem-description-1}{%
\section{Problem Description}\label{problem-description-1}}

\hypertarget{modeling-procedure-1}{%
\section{Modeling Procedure}\label{modeling-procedure-1}}

\hypertarget{zonesgroups}{%
\section{Zones/Groups}\label{zonesgroups}}

\hypertarget{properties-3}{%
\section{Properties}\label{properties-3}}

\hypertarget{b.c.-and-i.c.-1}{%
\section{B.C. and I.C.}\label{b.c.-and-i.c.-1}}

\hypertarget{initial-equilibrium-3}{%
\section{Initial Equilibrium}\label{initial-equilibrium-3}}

\hypertarget{alterations-3}{%
\section{Alterations}\label{alterations-3}}

\hypertarget{results-2}{%
\section{Results}\label{results-2}}

\hypertarget{reference-collective}{%
\chapter{Reference Collective}\label{reference-collective}}

\hypertarget{uplift-resistance-of-anchor-plate}{%
\subsection{Uplift Resistance of Anchor Plate}\label{uplift-resistance-of-anchor-plate}}

\hypertarget{before-1968}{%
\subsubsection{Before 1968}\label{before-1968}}

\begin{itemize}
\tightlist
\item
  Coulomb
\item
  Mohr
\item
  Kotter's equation
\item
  Balla (1961)
\item
  Mors
\item
  Matsuo
\item
  Vesic
\end{itemize}

\hypertarget{post-1968}{%
\subsubsection{Post-1968}\label{post-1968}}

\begin{itemize}
\tightlist
\item
  Meyerhof, G.G., and Adams, J.I. 1968
\item
  Meyerhof, G.G. 1973
\item
  Das, B.M., and Seeley, G.R. 1975
\item
  Rowe, R.K., and Davis, H. 1982
\item
  Dickin, E.A., and Leung, C.F. 1983
\item
  Murray, E.J., and Geddes, J.D. 1987
\item
  Dickin, E.A. 1988
\item
  Koutsabeloulis, N.C., and Griffiths, D.V. 1989
\end{itemize}

\hypertarget{post-2000}{%
\subsubsection{Post-2000}\label{post-2000}}

\begin{itemize}
\tightlist
\item
  Merifield, R.S., and Sloan, S.W. 2006
\end{itemize}

\hypertarget{numerical-analysis}{%
\subsection{Numerical Analysis}\label{numerical-analysis}}

\begin{itemize}
\tightlist
\item
  Krabbenhoft (2005)
\item
  Lyamin (2002)
\end{itemize}

\hypertarget{standards}{%
\subsection{Standards}\label{standards}}

\begin{itemize}
\tightlist
\item
  IEEE 2001
\item
  DS 1110, DS 1111
\end{itemize}

\hypertarget{textbook}{%
\subsection{Textbook}\label{textbook}}

\begin{itemize}
\tightlist
\item
  Das, B. M. 2013. Earth Anchors
\end{itemize}

\hypertarget{ph.d-thesis}{%
\subsection{Ph.D Thesis}\label{ph.d-thesis}}

\begin{itemize}
\tightlist
\item
  Evans
\item
  Levy
\item
  Feynman
\end{itemize}

\hypertarget{awarded-lectures}{%
\subsection{Awarded Lectures}\label{awarded-lectures}}

\begin{itemize}
\tightlist
\item
  Sloan
\item
  Houlsby
\item
  Sutherland
\end{itemize}


%%%%% REFERENCES
\setlength{\baselineskip}{0pt} % JEM: Single-space References

{\renewcommand*\MakeUppercase[1]{#1}%
\printbibliography[heading=bibintoc,title={\bibtitle}]}


\end{document}
